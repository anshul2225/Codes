(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    196235,       4339]
NotebookOptionsPosition[    194588,       4287]
NotebookOutlinePosition[    194990,       4304]
CellTagsIndexPosition[    194947,       4301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["", "Chapter"]], "Title",
 CellChangeTimes->{{3.6870914206743383`*^9, 3.6870916347122135`*^9}, {
   3.694437653549171*^9, 3.694437708718576*^9}, 3.695415415944749*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyad", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraints", "  ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.687091644933606*^9, 3.6870916617827406`*^9}, {
   3.6870916962673745`*^9, 3.687091698977764*^9}, {3.687091843446159*^9, 
   3.687091927663991*^9}, {3.687091997378615*^9, 3.687092029792903*^9}, {
   3.6870921739349337`*^9, 3.6870922167569466`*^9}, {3.687092316114529*^9, 
   3.6870923710757413`*^9}, {3.6870924228057437`*^9, 3.687092500615223*^9}, 
   3.687092531408264*^9, {3.6870925662888403`*^9, 3.6870925677363377`*^9}, {
   3.6870927707819705`*^9, 3.6870927767941923`*^9}, {3.6870928904730115`*^9, 
   3.6870929458981457`*^9}, {3.6870940699165397`*^9, 3.687094115406454*^9}, {
   3.6870941773350477`*^9, 3.687094189395732*^9}, {3.6870942521976957`*^9, 
   3.687094268235132*^9}, {3.687099086915219*^9, 3.687099093334505*^9}, {
   3.68710498126752*^9, 3.687104983120757*^9}, {3.6871051363449636`*^9, 
   3.687105175301113*^9}, {3.687105326425993*^9, 3.6871053988793583`*^9}, {
   3.68710551269433*^9, 3.687105596005273*^9}, {3.687105649697109*^9, 
   3.6871056613488913`*^9}, {3.687105724195839*^9, 3.687105840349375*^9}, {
   3.6871060184812794`*^9, 3.6871060980838556`*^9}, {3.687106163979847*^9, 
   3.6871061646663055`*^9}, {3.687111764836214*^9, 3.6871118579819503`*^9}, {
   3.687111946525428*^9, 3.6871119645698423`*^9}, {3.687112002845813*^9, 
   3.6871120207156444`*^9}, {3.6871120892095394`*^9, 3.687112134731367*^9}, {
   3.6871123086637363`*^9, 3.687112349260255*^9}, {3.687112477310791*^9, 
   3.687112497336903*^9}, {3.68711256287222*^9, 3.6871126006888523`*^9}, {
   3.6871126572726374`*^9, 3.687112807511366*^9}, {3.6871128611564946`*^9, 
   3.687112891987491*^9}, 3.687113013094186*^9, 3.687113546886441*^9, {
   3.6871138008515706`*^9, 3.6871138096566324`*^9}, {3.68711507243097*^9, 
   3.687115207394139*^9}, {3.6871153100902033`*^9, 3.6871154389293585`*^9}, {
   3.6871155038616447`*^9, 3.6871155264014897`*^9}, {3.6871156848118935`*^9, 
   3.687115689090408*^9}, {3.687115784133297*^9, 3.6871157847905245`*^9}, {
   3.6871159641462784`*^9, 3.6871160134247694`*^9}, {3.687116098983715*^9, 
   3.6871161296669083`*^9}, {3.6871164458380976`*^9, 3.687116447629821*^9}, {
   3.6871167213514137`*^9, 3.687116723089403*^9}, {3.687116946458098*^9, 
   3.6871169679453306`*^9}, 3.687117502631786*^9, {3.6871289181131554`*^9, 
   3.687128924871929*^9}, {3.6871695023557825`*^9, 3.687169503738884*^9}, {
   3.6871696200684233`*^9, 3.687169620406169*^9}, 3.6871698025363727`*^9, {
   3.6871698500357347`*^9, 3.6871698663929996`*^9}, {3.687169912219618*^9, 
   3.6871699125533857`*^9}, {3.6871702087983284`*^9, 
   3.6871702102758026`*^9}, {3.6871704200076094`*^9, 
   3.6871705257863674`*^9}, {3.6871705912159815`*^9, 3.687170628899294*^9}, {
   3.68717171480888*^9, 3.687171745998143*^9}, {3.6871736660323677`*^9, 
   3.6871736710921755`*^9}, {3.687175803652255*^9, 3.687175810932149*^9}, {
   3.6871766289376116`*^9, 3.6871766327485094`*^9}, 3.6871773150277147`*^9, {
   3.68717883141685*^9, 3.6871788353480988`*^9}, 3.6871789607966075`*^9, 
   3.687179120910703*^9, {3.6871798020773344`*^9, 3.687179802495718*^9}, {
   3.6871802649164753`*^9, 3.687180287341778*^9}, 3.6871834194736166`*^9, {
   3.6882517615382147`*^9, 3.6882518162817926`*^9}, {3.688262451123212*^9, 
   3.688262459930113*^9}, {3.6882629640060606`*^9, 3.6882629948588486`*^9}, {
   3.688263314646426*^9, 3.6882633149759827`*^9}, 3.6882635573731475`*^9, 
   3.6882635965670013`*^9, {3.6882638514760265`*^9, 3.6882638517318535`*^9}, {
   3.688263992769718*^9, 3.6882639929175158`*^9}, {3.688264130023219*^9, 
   3.688264130245245*^9}, 3.6882642908686347`*^9, {3.688264730463621*^9, 
   3.6882647306413507`*^9}, 3.6882650171536703`*^9, {3.6896371885490775`*^9, 
   3.6896372236158514`*^9}, {3.6896376134465103`*^9, 
   3.6896376137297306`*^9}, {3.689637877342311*^9, 3.689637877824407*^9}, {
   3.689650131970231*^9, 3.689650132159802*^9}, {3.6896505550928006`*^9, 
   3.6896505722642756`*^9}, {3.6942127736645603`*^9, 3.694212870233778*^9}, 
   3.6942129020122013`*^9, {3.694214261963922*^9, 3.6942142647589693`*^9}, {
   3.694214375079227*^9, 3.694214396550597*^9}, {3.69421728857784*^9, 
   3.694217292034254*^9}, 3.694222449449703*^9, {3.694222536194968*^9, 
   3.694222537783752*^9}, 3.69422270727486*^9, {3.694222758981551*^9, 
   3.694222812320199*^9}, {3.694222867290202*^9, 3.6942228941048937`*^9}, {
   3.6942261372560587`*^9, 3.694226137835857*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"FileNameSetter", "[", 
     RowBox[{"Dynamic", "[", "f", "]"}], "]"}], ",", 
    RowBox[{"Dynamic", "[", "f", "]"}]}], "}"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{3.694223006354384*^9, 3.694225708867052*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{Dynamic[$CellContext`f],"Open",All},
    "FileNameSetterBoxes"], ",", 
   DynamicBox[ToBoxes[$CellContext`f, StandardForm],
    ImageSizeCache->{307., {1., 9.}}]}], "}"}]], "Output",
 CellChangeTimes->{3.69429401951762*^9, 3.69438948422589*^9, 
  3.6963549826440067`*^9, 3.6967158215775433`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"getPoses", "[", "importedFile_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"xInput", ",", "yInput", ",", "\[Theta]Input", ","}], "*)"}], 
     RowBox[{"selectedDyadIndexes", ",", "Za", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xInput", " ", "=", " ", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"importedFile", ",", 
         RowBox[{
          RowBox[{"XMLElement", "[", 
           RowBox[{"\"\<constraint\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"\"\<x\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}],
             ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
         "\[Infinity]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yInput", " ", "=", " ", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"importedFile", ",", 
         RowBox[{
          RowBox[{"XMLElement", "[", 
           RowBox[{"\"\<constraint\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"\"\<y\>\"", "\[Rule]", "atrib_"}], ",", "___"}], "}"}],
             ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
         "\[Infinity]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]Input", " ", "=", " ", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{"importedFile", ",", 
          RowBox[{
           RowBox[{"XMLElement", "[", 
            RowBox[{"\"\<constraint\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"\"\<angle\>\"", "\[Rule]", "atrib_"}], ",", "___"}], 
              "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "atrib"}], ",", 
          "\[Infinity]"}], "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"selectedDyadIndexes", " ", "=", " ", 
      RowBox[{"Cases", "[", 
       RowBox[{"importedFile", ",", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<synthesized\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"\"\<selected\>\"", "\[Rule]", "value_"}], ",", "___"}], 
            "}"}], ",", "___"}], "]"}], "\[RuleDelayed]", "value"}], ",", 
        "\[Infinity]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dyadVectorsList", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"importedFile", ",", 
         RowBox[{
          RowBox[{"XMLElement", "[", 
           RowBox[{"\"\<dyadVector\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<q1\>\"", "\[Rule]", " ", "q1_"}], ",", 
              RowBox[{"\"\<q2\>\"", "\[Rule]", " ", "q2_"}], ",", 
              RowBox[{"\"\<q3\>\"", "\[Rule]", " ", "q3_"}], ",", 
              RowBox[{"\"\<q4\>\"", "\[Rule]", " ", "q4_"}], ",", 
              RowBox[{"\"\<q5\>\"", "\[Rule]", " ", "q5_"}], ",", 
              RowBox[{"\"\<q6\>\"", "\[Rule]", " ", "q6_"}], ",", 
              RowBox[{"\"\<q7\>\"", "\[Rule]", " ", "q7_"}], ",", 
              RowBox[{"\"\<q8\>\"", "\[Rule]", " ", "q8_"}]}], "}"}], ",", 
            "_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
           "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", 
            "q7", ",", "q8"}], "}"}]}], ",", "\[Infinity]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Za", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "xInput", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Zz", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "xInput", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "xInput", "]"}], "+", "1"}], ")"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Za", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"xInput", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"\[Theta]Input", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"yInput", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"\[Theta]Input", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], " ", "]"}]}]}], 
           ")"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"Za", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"xInput", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"\[Theta]Input", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], " ", "]"}]}], "+", 
            RowBox[{
             RowBox[{"yInput", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"\[Theta]Input", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Za", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Theta]Input", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"Za", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Theta]Input", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Zz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", 
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"Zz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/", 
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"Zz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/", 
          RowBox[{
           RowBox[{"Za", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FormEqn", "[", "va_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "*", "z"}], "-", "y"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", "*", "z"}], "+", "x"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "*", "z"}], "+", "y"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", "*", "z"}], "-", "x"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "*", "z"}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "7", "]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "^", "2"}], "-", "1"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{"[", "8", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "^", "2"}], "+", "1"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interSectingFigure", "[", 
    RowBox[{"eq1_", ",", "eq2_"}], "]"}], ":=", 
   RowBox[{"ContourPlot3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"eq1", "\[Equal]", "0"}], ",", 
       RowBox[{"eq2", "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
     RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
     RowBox[{"MeshStyle", "\[Rule]", "Gray"}], ",", 
     RowBox[{"Mesh", "\[Rule]", "3"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"XXX", ",", "YYY", ",", "ZZZ"}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "16", "]"}]}], ",", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "15", "]"}]}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0.7", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0.7", "]"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.687091644933606*^9, 3.6870916617827406`*^9}, {
   3.6870916962673745`*^9, 3.687091698977764*^9}, {3.687091843446159*^9, 
   3.687091927663991*^9}, {3.687091997378615*^9, 3.687092029792903*^9}, {
   3.6870921739349337`*^9, 3.6870922167569466`*^9}, {3.687092316114529*^9, 
   3.6870923710757413`*^9}, {3.6870924228057437`*^9, 3.687092500615223*^9}, 
   3.687092531408264*^9, {3.6870925662888403`*^9, 3.6870925677363377`*^9}, {
   3.6870927707819705`*^9, 3.6870927767941923`*^9}, {3.6870928904730115`*^9, 
   3.6870929458981457`*^9}, {3.6870940699165397`*^9, 3.687094115406454*^9}, {
   3.6870941773350477`*^9, 3.687094189395732*^9}, {3.6870942521976957`*^9, 
   3.687094268235132*^9}, {3.687099086915219*^9, 3.687099093334505*^9}, {
   3.68710498126752*^9, 3.687104983120757*^9}, {3.6871051363449636`*^9, 
   3.687105175301113*^9}, {3.687105326425993*^9, 3.6871053988793583`*^9}, {
   3.68710551269433*^9, 3.687105596005273*^9}, {3.687105649697109*^9, 
   3.6871056613488913`*^9}, {3.687105724195839*^9, 3.687105840349375*^9}, {
   3.6871060184812794`*^9, 3.6871060980838556`*^9}, {3.687106163979847*^9, 
   3.6871061646663055`*^9}, {3.687111764836214*^9, 3.6871118579819503`*^9}, {
   3.687111946525428*^9, 3.6871119645698423`*^9}, {3.687112002845813*^9, 
   3.6871120207156444`*^9}, {3.6871120892095394`*^9, 3.687112134731367*^9}, {
   3.6871123086637363`*^9, 3.687112349260255*^9}, {3.687112477310791*^9, 
   3.687112497336903*^9}, {3.68711256287222*^9, 3.6871126006888523`*^9}, {
   3.6871126572726374`*^9, 3.687112807511366*^9}, {3.6871128611564946`*^9, 
   3.687112891987491*^9}, 3.687113013094186*^9, 3.687113546886441*^9, {
   3.6871138008515706`*^9, 3.6871138096566324`*^9}, {3.68711507243097*^9, 
   3.687115207394139*^9}, {3.6871153100902033`*^9, 3.6871154389293585`*^9}, {
   3.6871155038616447`*^9, 3.6871155264014897`*^9}, {3.6871156848118935`*^9, 
   3.687115689090408*^9}, {3.687115784133297*^9, 3.6871157847905245`*^9}, {
   3.6871159641462784`*^9, 3.6871160134247694`*^9}, {3.687116098983715*^9, 
   3.6871161296669083`*^9}, {3.6871164458380976`*^9, 3.687116447629821*^9}, {
   3.6871167213514137`*^9, 3.687116723089403*^9}, {3.687116946458098*^9, 
   3.6871169679453306`*^9}, 3.687117502631786*^9, {3.6871289181131554`*^9, 
   3.687128924871929*^9}, {3.6871695023557825`*^9, 3.687169503738884*^9}, {
   3.6871696200684233`*^9, 3.687169620406169*^9}, 3.6871698025363727`*^9, {
   3.6871698500357347`*^9, 3.6871698663929996`*^9}, {3.687169912219618*^9, 
   3.6871699125533857`*^9}, {3.6871702087983284`*^9, 
   3.6871702102758026`*^9}, {3.6871704200076094`*^9, 
   3.6871705257863674`*^9}, {3.6871705912159815`*^9, 3.687170628899294*^9}, {
   3.68717171480888*^9, 3.687171745998143*^9}, {3.6871736660323677`*^9, 
   3.6871736710921755`*^9}, {3.687175803652255*^9, 3.687175810932149*^9}, {
   3.6871766289376116`*^9, 3.6871766327485094`*^9}, 3.6871773150277147`*^9, {
   3.68717883141685*^9, 3.6871788353480988`*^9}, 3.6871789607966075`*^9, 
   3.687179120910703*^9, {3.6871798020773344`*^9, 3.687179802495718*^9}, {
   3.6871802649164753`*^9, 3.687180287341778*^9}, 3.6871834194736166`*^9, {
   3.6882517615382147`*^9, 3.6882518162817926`*^9}, {3.688262451123212*^9, 
   3.688262459930113*^9}, {3.6882629640060606`*^9, 3.6882629948588486`*^9}, {
   3.688263314646426*^9, 3.6882633149759827`*^9}, 3.6882635573731475`*^9, 
   3.6882635965670013`*^9, {3.6882638514760265`*^9, 3.6882638517318535`*^9}, {
   3.688263992769718*^9, 3.6882639929175158`*^9}, {3.688264130023219*^9, 
   3.688264130245245*^9}, 3.6882642908686347`*^9, {3.688264730463621*^9, 
   3.6882647306413507`*^9}, 3.6882650171536703`*^9, {3.6896371885490775`*^9, 
   3.6896372236158514`*^9}, {3.6896376134465103`*^9, 
   3.6896376137297306`*^9}, {3.689637877342311*^9, 3.689637877824407*^9}, {
   3.689650131970231*^9, 3.689650132159802*^9}, {3.6896505550928006`*^9, 
   3.6896505722642756`*^9}, {3.6942127736645603`*^9, 3.694212870233778*^9}, 
   3.6942129020122013`*^9, {3.694214261963922*^9, 3.6942142647589693`*^9}, {
   3.694214375079227*^9, 3.694214396550597*^9}, {3.69421728857784*^9, 
   3.694217292034254*^9}, 3.694222449449703*^9, {3.694222536194968*^9, 
   3.694222537783752*^9}, 3.69422270727486*^9, 3.694222894106078*^9, 
   3.694223006356332*^9, {3.694224051191194*^9, 3.6942240625647306`*^9}, 
   3.6942242181024303`*^9, {3.694224284529529*^9, 3.694224288185588*^9}, 
   3.694225708867403*^9, 3.69426262008712*^9, {3.6942922010721407`*^9, 
   3.694292213636302*^9}, {3.696364507677517*^9, 3.6963645084577312`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fourbarSynthesis", "[", 
     RowBox[{"Xgg_", ",", "Ygg_", ",", "Tgg_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{
        "Za", ",", "dZa", ",", "Aa", ",", "V", ",", " ", "W", ",", "U", ",", 
         "p1", ",", "p2", ",", "p3", ",", "p4", ",", "q", ",", 
         "validSolutions", ",", "vars", ",", "Fx", ",", " ", "Fy", ",", "Mx", 
         ",", "My"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Num", " ", "=", " ", 
        RowBox[{"Length", "[", "Xgg", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Aa", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "Num"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "8"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Aa", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Za", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "Num"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"(", 
           RowBox[{"Num", "+", "1"}], ")"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "convert", " ", "into", " ", "planar", " ", "quaternions"}], ";"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Za", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Xgg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"Tgg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Ygg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"Tgg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}]}], 
             ")"}]}]}], ";", 
          RowBox[{
           RowBox[{
            RowBox[{"Za", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Xgg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"Tgg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Ygg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"Tgg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Za", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "=", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"Tgg", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Za", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "=", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"Tgg", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "calulating", " ", "each", " ", "row", " ", "of", " ", "matrix", 
            " ", "A"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Arow", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Za", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Za", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Za", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Aa", ",", "Arow"}], "]"}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"H", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"Tgg", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"Tgg", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"Xgg", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"Tgg", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"Tgg", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Ygg", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"U", ",", "W", ",", "v"}], "}"}], "=", 
        RowBox[{"SingularValueDecomposition", "[", "Aa", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V", " ", "=", " ", 
        RowBox[{"v", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"V", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", 
       RowBox[{"p2", "=", 
        RowBox[{"V", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", 
       RowBox[{"p3", "=", 
        RowBox[{"V", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"a", "*", "p1"}], "+", 
         RowBox[{"b", "*", "p2"}], "+", "p3"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "*", 
           RowBox[{"q", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "*", 
           RowBox[{"q", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"q", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "*", 
           RowBox[{"q", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f2", "=", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "*", 
            RowBox[{"q", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "-", 
           RowBox[{"0.5", "*", 
            RowBox[{"q", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"q", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "-", 
           RowBox[{"0.5", "*", 
            RowBox[{"q", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"q", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F1", "=", 
        RowBox[{"N", "[", 
         RowBox[{"Expand", "[", "f1", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"N", "[", 
         RowBox[{"Expand", "[", "f2", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "construct", " ", "the", " ", "two", " ", "quadratic", " ", 
         "consrtaint", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Sol", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"F1", "\[Equal]", "0"}], ",", 
            RowBox[{"F2", "\[Equal]", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "/.", "Sol"}], ",", "\[IndentingNewLine]", 
           RowBox[{"b", "/.", "Sol"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "Sol", "]"}]}], "}"}]}], "]"}]}], "}"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MatrixForm", "[", "vars", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"validSolutions", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"valid", " ", "=", " ", "True"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"l", "=", "1"}], ",", " ", 
            RowBox[{"l", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"vars", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "l"}], "]"}], "]"}], "]"}], "]"}], ">", 
                "0.0001"}], ",", " ", 
               RowBox[{"valid", " ", "=", " ", "False"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Equal", "[", 
             RowBox[{"valid", "  ", ",", " ", "True"}], "]"}], " ", ",", " ", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"validSolutions", ",", 
              RowBox[{"Re", "[", 
               RowBox[{"vars", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"validSolutions", " ", "=", " ", 
        RowBox[{"Transpose", "[", "validSolutions", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Real Solutions:\>\"", "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MatrixForm", "[", "validSolutions", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "]"}], ".", 
          "validSolutions"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "p", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cenX", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "3"}], "]"}], "]"}], "*", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "6"}], "]"}], "]"}]}], "+", 
              RowBox[{"2", "*", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}], "*", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "7"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cenY", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "6"}], "]"}], "]"}]}], "-", 
             RowBox[{"2", "*", 
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "3"}], "]"}], "]"}], "*", 
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "7"}], "]"}], "]"}]}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cenZ", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "3"}], "]"}], "]"}], "^", "2"}]}], ")"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Fx", " ", "=", " ", 
           RowBox[{"cenX", "/", "cenZ"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Fy", " ", "=", " ", 
           RowBox[{"cenY", "/", "cenZ"}]}], ";", "\[IndentingNewLine]", "  ", 
          "\[IndentingNewLine]", 
          RowBox[{"movingFramePoint", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "6"}], "]"}], "]"}], "*", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "5"}], "]"}], "]"}]}], "-", 
               RowBox[{"2.0", "*", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "7"}], "]"}], "]"}], "*", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "4"}], "]"}], "]"}]}]}], ")"}], ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "6"}], "]"}], "]"}], "*", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "+", 
                RowBox[{"2.0", "*", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "7"}], "]"}], "]"}], "*", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "5"}], "]"}], "]"}]}]}], ")"}]}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "4"}], "]"}], "]"}], "*", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "5"}], "]"}], "]"}], "*", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "5"}], "]"}], "]"}]}]}], ")"}]}], "}"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dyad", ",", 
            RowBox[{"p", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"fixedFramePoint", " ", "=", " ", 
           RowBox[{"H", ".", "movingFramePoint"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Mx", " ", "=", " ", 
           RowBox[{
            RowBox[{"fixedFramePoint", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"fixedFramePoint", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"My", " ", "=", " ", 
           RowBox[{
            RowBox[{"fixedFramePoint", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"fixedFramePoint", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.6816694665123973`*^9, 3.6816695374064226`*^9, {3.681669589022599*^9, 
   3.681669594145152*^9}, 3.6816696609984293`*^9, {3.681669712324112*^9, 
   3.6816697475578303`*^9}, {3.681669850195014*^9, 3.6816701008068094`*^9}, {
   3.681670147993924*^9, 3.681670214164612*^9}, {3.681670287202335*^9, 
   3.681670299422474*^9}, {3.6816703484465017`*^9, 3.6816703501064653`*^9}, {
   3.6816704910541077`*^9, 3.681670555772669*^9}, 3.6816710120557733`*^9, {
   3.6816711018386936`*^9, 3.6816711464643393`*^9}, {3.681671229046154*^9, 
   3.6816714415393143`*^9}, {3.681671480045024*^9, 3.6816714848633313`*^9}, {
   3.681671888707701*^9, 3.681671905246356*^9}, {3.6816720570849123`*^9, 
   3.6816720674410696`*^9}, {3.6816721065969496`*^9, 
   3.6816721528629026`*^9}, {3.6816722153904934`*^9, 
   3.6816722464771614`*^9}, {3.6816723593600626`*^9, 
   3.6816723792273664`*^9}, {3.681672761907688*^9, 3.681672765579791*^9}, {
   3.6816731530500126`*^9, 3.6816731690926847`*^9}, 3.681673252895322*^9, {
   3.6816734023444557`*^9, 3.681673403435768*^9}, {3.681692316997011*^9, 
   3.6816923248999863`*^9}, 3.6816925517780495`*^9, {3.681692594014946*^9, 
   3.681692618122473*^9}, {3.681692692238675*^9, 3.6816927253812585`*^9}, {
   3.681692779271718*^9, 3.681692812525522*^9}, {3.6816930747903023`*^9, 
   3.6816930988170156`*^9}, {3.681693161151969*^9, 3.681693206950984*^9}, {
   3.6818400304468107`*^9, 3.6818400822390437`*^9}, {3.681840121832143*^9, 
   3.6818401314389324`*^9}, 3.6818401639176097`*^9, {3.6818402732337227`*^9, 
   3.68184028896096*^9}, {3.6818449789505777`*^9, 3.6818449831708307`*^9}, {
   3.6818450933894978`*^9, 3.681845097287792*^9}, {3.6818456497863183`*^9, 
   3.68184574287831*^9}, {3.681845773247057*^9, 3.6818458427515836`*^9}, {
   3.6818461176939893`*^9, 3.6818461254702005`*^9}, {3.6818462522436333`*^9, 
   3.6818463823011723`*^9}, {3.6818464216062145`*^9, 3.6818464384053197`*^9}, 
   3.6818574760125313`*^9, 3.681858381279792*^9, {3.681910772954012*^9, 
   3.681910931959003*^9}, {3.6819109748326735`*^9, 3.681911000122165*^9}, 
   3.681911618121922*^9, {3.6820152202414274`*^9, 3.6820152785390806`*^9}, 
   3.6820154823125134`*^9, {3.682015530019001*^9, 3.682015532435066*^9}, {
   3.6821825892667203`*^9, 3.6821825894821024`*^9}, {3.6829392028681297`*^9, 
   3.682939203400024*^9}, {3.6829392756208854`*^9, 3.6829392758402166`*^9}, 
   3.6829394176725907`*^9, {3.6829551641579027`*^9, 3.6829551652277822`*^9}, {
   3.6829821644680667`*^9, 3.6829822263573313`*^9}, {3.682982470778805*^9, 
   3.6829825481959143`*^9}, {3.6829847624686327`*^9, 3.68298476285336*^9}, {
   3.68298498350067*^9, 3.682985008210811*^9}, {3.682985042573222*^9, 
   3.682985083045397*^9}, {3.682985114557955*^9, 3.682985155856018*^9}, {
   3.682985222379801*^9, 3.682985222857755*^9}, {3.6829852572605824`*^9, 
   3.6829853047005663`*^9}, {3.694262620090027*^9, 3.6942626501237507`*^9}, {
   3.694262829187149*^9, 3.694262865463298*^9}, {3.694268288110675*^9, 
   3.694268323605208*^9}, {3.694268515374752*^9, 3.694268564899893*^9}, {
   3.694268601353978*^9, 3.694268613285928*^9}, {3.694268840421525*^9, 
   3.694268841128909*^9}, {3.694268875881678*^9, 3.6942688766163807`*^9}, {
   3.694268939260723*^9, 3.694268954149776*^9}, 3.694269052430632*^9, {
   3.694269318052655*^9, 3.69426933082693*^9}, 3.6942695012528687`*^9, {
   3.694269671511301*^9, 3.694269692641549*^9}, {3.69426983048267*^9, 
   3.69426986006991*^9}, {3.694290318777419*^9, 3.694290330719116*^9}, {
   3.6942922010763607`*^9, 3.6942922136414623`*^9}, {3.694294478781047*^9, 
   3.694294500631773*^9}, {3.694295420135468*^9, 3.694295534355359*^9}, {
   3.69429560697832*^9, 3.6942956218773613`*^9}, {3.695415329619982*^9, 
   3.695415336065529*^9}, {3.696360520801148*^9, 3.696360521455867*^9}, 
   3.696360553994357*^9, {3.696360600758587*^9, 3.696360601822781*^9}, {
   3.696360791634742*^9, 3.696360895181644*^9}, {3.6963610370317173`*^9, 
   3.696361065098724*^9}, {3.696362595201414*^9, 3.696362606919649*^9}, {
   3.69636377071852*^9, 3.6963637711150627`*^9}, {3.6963638471657057`*^9, 
   3.6963638929684*^9}, {3.696364442019168*^9, 3.696364461941593*^9}, 
   3.6966975932667007`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"drawPoses", "[", 
    RowBox[{"d1_", ",", "d2_", ",", "theta_", ",", "length_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Num", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xaxis", "=", " ", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"length", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Yaxis", " ", "=", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "length"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Num", " ", "=", " ", 
       RowBox[{"Length", "[", "d1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Xray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"Xaxis", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "Num"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Yray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"Yaxis", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "Num"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"Num", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArrowLength", " ", "=", " ", "length"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Xray", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"d1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"d2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"ArrowLength", " ", "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"d2", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"ArrowLength", " ", "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "}"}]}], 
              "}"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Yray", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"d1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"d2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"ArrowLength", " ", "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"d2", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"ArrowLength", " ", "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "}"}]}], 
              "}"}], "]"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"fixedFrame", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"Xaxis", ",", "Yaxis"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posesFrame", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"Xray", ",", "Yray"}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.68169332417715*^9, {3.68169336427743*^9, 3.6816934071286516`*^9}, {
   3.681693473782596*^9, 3.681693649439977*^9}, {3.6816936871625147`*^9, 
   3.681693751436578*^9}, {3.6816937849731083`*^9, 3.681693894724369*^9}, {
   3.6816940249948673`*^9, 3.6816940765782537`*^9}, {3.6816941081770334`*^9, 
   3.6816941542514205`*^9}, {3.6816942419901752`*^9, 
   3.6816943484537497`*^9}, {3.681694571551982*^9, 3.681694606858383*^9}, {
   3.6817298858163557`*^9, 3.681729939689172*^9}, {3.681729974363933*^9, 
   3.681730026055934*^9}, {3.6817300828189993`*^9, 3.6817301165770607`*^9}, {
   3.681730201745673*^9, 3.681730263287685*^9}, {3.681730300769127*^9, 
   3.6817303142121925`*^9}, {3.681730434220647*^9, 3.6817306310740213`*^9}, {
   3.6817306752906485`*^9, 3.681730735676798*^9}, {3.681730783933401*^9, 
   3.6817307910675416`*^9}, {3.681730854866083*^9, 3.6817308637341776`*^9}, {
   3.681730962652916*^9, 3.681731153751998*^9}, {3.6817312672025013`*^9, 
   3.6817312914544964`*^9}, {3.681731395346202*^9, 3.6817314607234845`*^9}, {
   3.681731528341696*^9, 3.6817315465920362`*^9}, {3.681731629812788*^9, 
   3.6817316574014997`*^9}, {3.681733098666749*^9, 3.681733219514661*^9}, {
   3.681733488214177*^9, 3.6817335028063245`*^9}, {3.681733566805436*^9, 
   3.6817335788467064`*^9}, {3.6817336259377837`*^9, 
   3.6817336517681093`*^9}, {3.6817337344097967`*^9, 
   3.6817337950533376`*^9}, {3.6817338776255426`*^9, 
   3.6817339707028236`*^9}, {3.6817340202808867`*^9, 
   3.6817340455829716`*^9}, {3.68173416618672*^9, 3.68173426948217*^9}, {
   3.681735046370719*^9, 3.681735086091151*^9}, {3.6817351272469215`*^9, 
   3.6817351697582903`*^9}, {3.681736259606057*^9, 3.6817363480670276`*^9}, {
   3.6817363913563623`*^9, 3.6817364122348104`*^9}, {3.681736459008836*^9, 
   3.6817364596627407`*^9}, {3.681736519918532*^9, 3.681736584361623*^9}, {
   3.6818251033208876`*^9, 3.681825112471444*^9}, {3.6818401968305397`*^9, 
   3.68184020512928*^9}, {3.6818403196288657`*^9, 3.6818405057831445`*^9}, {
   3.6818405372885346`*^9, 3.681840580674808*^9}, {3.6818406936775775`*^9, 
   3.681840740041038*^9}, {3.681840784480874*^9, 3.6818408059850597`*^9}, {
   3.681840936517394*^9, 3.681840948674115*^9}, {3.681841000783183*^9, 
   3.6818410614510202`*^9}, {3.681841103137374*^9, 3.6818411938661785`*^9}, {
   3.6818412931958876`*^9, 3.681841321318488*^9}, {3.6818413567609496`*^9, 
   3.6818414080485387`*^9}, {3.6818414617769003`*^9, 
   3.6818416154289403`*^9}, {3.6818416649050274`*^9, 
   3.6818416949924855`*^9}, {3.681841774890279*^9, 3.681841815902917*^9}, {
   3.6818418611926594`*^9, 3.6818419226327305`*^9}, {3.6818419550690117`*^9, 
   3.681841973021841*^9}, {3.6818420172352095`*^9, 3.6818422706861057`*^9}, {
   3.6818424449953814`*^9, 3.681842449878621*^9}, {3.6818427564695196`*^9, 
   3.68184277436943*^9}, {3.681842842304406*^9, 3.6818428685008373`*^9}, {
   3.6818429939534225`*^9, 3.6818429942378936`*^9}, {3.681843312858292*^9, 
   3.6818433158584547`*^9}, {3.6818460020478377`*^9, 
   3.6818460093088245`*^9}, {3.6818680929105153`*^9, 
   3.6818680986459455`*^9}, {3.682182627460618*^9, 3.682182634990697*^9}, {
   3.682938901812895*^9, 3.682938924142705*^9}, {3.682938974561425*^9, 
   3.682938997315986*^9}, {3.682939099495508*^9, 3.682939136271013*^9}, {
   3.6829391880645685`*^9, 3.6829391889343348`*^9}, {3.682939514063258*^9, 
   3.6829395401896877`*^9}, {3.682939836147723*^9, 3.682939860572907*^9}, 
   3.6829400360969453`*^9, 3.682940614002117*^9, {3.6829413375921807`*^9, 
   3.682941361398595*^9}, {3.6829467022742767`*^9, 3.6829467271344795`*^9}, {
   3.6829467713173485`*^9, 3.6829467718012767`*^9}, {3.6829471187257233`*^9, 
   3.682947127474616*^9}, {3.682947163343487*^9, 3.682947178660846*^9}, {
   3.682947235776235*^9, 3.682947304505855*^9}, {3.6829475365759034`*^9, 
   3.6829475633233514`*^9}, {3.6829476005857363`*^9, 
   3.6829476515192165`*^9}, {3.6829497724080577`*^9, 
   3.6829497727081585`*^9}, {3.6829552701670732`*^9, 3.682955283735717*^9}, {
   3.682955371937847*^9, 3.6829553932963123`*^9}, {3.6829665367703485`*^9, 
   3.6829665425200644`*^9}, {3.6829665808466935`*^9, 3.682966587663291*^9}, {
   3.6829686491412563`*^9, 3.682968687524273*^9}, {3.682987178658579*^9, 
   3.6829872252807937`*^9}, {3.6942922010772057`*^9, 3.694292213642061*^9}, {
   3.69429299761817*^9, 3.694293015014539*^9}, {3.694293112152095*^9, 
   3.6942931365614*^9}, {3.694293272108759*^9, 3.694293284967472*^9}, {
   3.694293336896587*^9, 3.694293420215069*^9}, {3.694293745911827*^9, 
   3.694293746227231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulateMechanism", "[", 
   RowBox[{"dyad1_", ",", "dyad2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"weight", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Flag", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Flag", "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Xr1", "=", "0"}], ",", 
           RowBox[{"Xr2", "=", "0"}], ",", 
           RowBox[{"Rr1", "=", "0"}], ",", 
           RowBox[{"Xr2", "=", "0"}], ",", 
           RowBox[{"Yr2", "=", "0"}], ",", 
           RowBox[{"Rr2", "=", "0"}], ",", 
           RowBox[{"x1", "=", "0"}], ",", 
           RowBox[{"y1", "=", "0"}], ",", 
           RowBox[{"x2", "=", "0"}], ",", 
           RowBox[{"y2", "=", "0"}], ",", 
           RowBox[{"R1x", "=", "0"}], ",", 
           RowBox[{"R1y", "=", "0"}], ",", 
           RowBox[{"R2x", "=", "0"}], ",", 
           RowBox[{"R2y", "=", "0"}], ",", 
           RowBox[{"Px", "=", "0"}], ",", 
           RowBox[{"Py", "=", "0"}], ",", 
           RowBox[{"theta", "=", "0"}], ",", 
           RowBox[{"weight", "=", "0"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "above", " ", "step", " ", "is", " ", "to", " ", 
          "choose", " ", "from", " ", "6", " ", "different", " ", 
          "combinations", " ", "of", " ", "4", " ", "dyads"}], ",", " ", 
         RowBox[{
         "including", " ", "judging", " ", "if", " ", "they", " ", "are", " ",
           "real", " ", "solution", " ", "or", " ", "complex"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Flag", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"dyad1", "=", 
           RowBox[{"dyad1", "/", 
            RowBox[{"Norm", "[", "dyad1", "]"}]}]}], ";", 
          RowBox[{"dyad2", "=", 
           RowBox[{"dyad2", "/", 
            RowBox[{"Norm", "[", "dyad2", "]"}]}]}], ";", 
          RowBox[{"IsP", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "0.03"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", "0.03"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad1", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", "0.03"}]}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "0.03"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", "0.03"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"dyad2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", "0.03"}]}]}], 
            ",", 
            RowBox[{"(*", 
             RowBox[{"PR", " ", "joint"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", " ", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"dyad2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "<", "0.03"}], "&&", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", "0.03"}], "&&", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", "0.03"}]}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"dyado", "=", "dyad2"}], ";", 
                RowBox[{"dyad2", "=", "dyad1"}], ";", 
                RowBox[{"dyad1", "=", "dyado"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Par2", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad2", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad2", "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], "*", 
                  RowBox[{
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "8", "]"}], "]"}], "/", 
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "^", "2"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Par2", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"Par2", ",", "0.001"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"a1", "/", "a0"}], ",", 
               RowBox[{"a2", "/", "a0"}], ",", 
               RowBox[{"a3", "/", "a0"}], ",", 
               RowBox[{"x1", "/", "x3"}], ",", 
               RowBox[{"x2", "/", "x3"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Xc", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"Yc", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", 
             RowBox[{"Rc", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{"Par2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"x2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ";", 
             RowBox[{"y2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Par1", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dyad1", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", 
                RowBox[{"dyad1", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"dyad1", "[", 
                   RowBox[{"[", "8", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"dyad1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "^", "2"}]}]}], ")"}], 
                   "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}]}],
                 ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Par1", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"Par1", ",", "0.001"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"a1", ",", "a2", ",", "a3", ",", 
               RowBox[{"x1", "/", "x3"}], ",", 
               RowBox[{"x2", "/", "x3"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"a", "=", 
              RowBox[{"2", "*", 
               RowBox[{"Par1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
             RowBox[{"b", "=", 
              RowBox[{"2", "*", 
               RowBox[{"Par1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
             RowBox[{"c", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"x1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"y1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"L", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], "]"}]}], 
             ";", 
             RowBox[{"L2", "=", "L"}], ";", "\[IndentingNewLine]", 
             RowBox[{"px", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "x2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}], ")"}]}], 
               "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "y2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}], ")"}]}]}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"py", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "x2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "y2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}], ")"}]}]}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"coupler", " ", "position", " ", "point", 
               RowBox[{"(", 
                RowBox[{"in", " ", "coupler", " ", "moving", " ", "frame"}], 
                ")"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"cctheta", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}]}], ";", 
             RowBox[{"sstheta", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"coupler", " ", "position", " ", "angle", 
               RowBox[{"(", 
                RowBox[{"in", " ", "coupler", " ", "moving", " ", "frame"}], 
                ")"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"R1x", "=", 
                 RowBox[{"Xc", "+", 
                  RowBox[{"Rc", "*", 
                   RowBox[{"Cos", "[", "phi", "]"}]}]}]}], ";", "\n", 
                RowBox[{"R1y", "=", 
                 RowBox[{"Yc", "+", 
                  RowBox[{"Rc", "*", 
                   RowBox[{"Sin", "[", "phi", "]"}]}]}]}], ";", "\n", 
                RowBox[{"Cc", "=", 
                 RowBox[{
                  RowBox[{"-", "c"}], "/", "a"}]}], ";", "\n", 
                RowBox[{"R2x", "=", "Cc"}], ";", "\n", 
                RowBox[{"R2y", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"branch", "\[Equal]", "1"}], ",", 
                   RowBox[{"R1y", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"L", "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R1x", "-", "Cc"}], ")"}], "^", "2"}]}], "]"}]}], 
                   ",", 
                   RowBox[{"R1y", "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"L", "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R1x", "-", "Cc"}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], ";", "\n", 
                RowBox[{"Ctheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2x", "-", "R1x"}], ")"}], "/", "L"}]}], ";", 
                "\n", 
                RowBox[{"Stheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2y", "-", "R1y"}], ")"}], "/", "L"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L", "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R1x", "-", "Cc"}], ")"}], "^", "2"}]}], ")"}], 
                   "<", "0"}], ",", 
                  RowBox[{
                   RowBox[{"R2x", "=", "R1x"}], ";", 
                   RowBox[{"R2y", "=", "R1y"}], ";", 
                   RowBox[{"Ctheta", "=", "1"}], ";", 
                   RowBox[{"Stheta", "=", "0"}], ";", 
                   RowBox[{"flag", "=", "1"}]}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "\[NotEqual]", "0"}], ",", 
               RowBox[{
                RowBox[{"R1x", "=", 
                 RowBox[{"Xc", "+", 
                  RowBox[{"Rc", "*", 
                   RowBox[{"Cos", "[", "phi", "]"}]}]}]}], ";", 
                RowBox[{"R1y", "=", 
                 RowBox[{"Yc", "+", 
                  RowBox[{"Rc", "*", 
                   RowBox[{"Sin", "[", "phi", "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"K", "=", 
                 RowBox[{
                  RowBox[{"-", "a"}], "/", "b"}]}], ";", 
                RowBox[{"Cc", "=", 
                 RowBox[{
                  RowBox[{"-", "c"}], "/", "b"}]}], ";", "\n", 
                RowBox[{"AA", "=", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"K", "^", "2"}]}], ")"}]}], ";", "\n", 
                RowBox[{"BB", "=", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "R1x"}], "-", 
                    RowBox[{"2", "*", "K", "*", "Cc"}], "+", 
                    RowBox[{"2", "*", "R1y", "*", "K"}]}], ")"}]}]}], ";", 
                "\n", 
                RowBox[{"CC", "=", 
                 RowBox[{
                  RowBox[{"R1x", "^", "2"}], "+", 
                  RowBox[{"Cc", "^", "2"}], "+", 
                  RowBox[{"R1y", "^", "2"}], "-", 
                  RowBox[{"L", "^", "2"}], "-", 
                  RowBox[{"2", "*", "R1y", "*", "Cc"}]}]}], ";", "\n", 
                RowBox[{"R2x", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"branch", "\[Equal]", "1"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "BB"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"BB", "^", "2"}], "-", 
                    RowBox[{"4", "*", "AA", "*", "CC"}]}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "AA"}], ")"}]}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "BB"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"BB", "^", "2"}], "-", 
                    RowBox[{"4", "*", "AA", "*", "CC"}]}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "AA"}], ")"}]}]}], "]"}]}], ";", "\n", 
                RowBox[{"R2y", "=", 
                 RowBox[{
                  RowBox[{"K", "*", "R2x"}], "+", "Cc"}]}], ";", "\n", 
                RowBox[{"Ctheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2x", "-", "R1x"}], ")"}], "/", "L"}]}], ";", 
                "\n", 
                RowBox[{"Stheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2y", "-", "R1y"}], ")"}], "/", "L"}]}], ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"BB", "^", "2"}], "-", 
                    RowBox[{"4", "*", "AA", "*", "CC"}]}], ")"}], "<", "0"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"R2x", "=", "R1x"}], ";", 
                   RowBox[{"R2y", "=", "R1y"}], ";", 
                   RowBox[{"Ctheta", "=", "1"}], ";", 
                   RowBox[{"Stheta", "=", "0"}], ";", 
                   RowBox[{"flag", "=", "1"}]}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ctheta", "=", 
              RowBox[{
               RowBox[{"Ctheta", "*", "cctheta"}], "-", 
               RowBox[{"Stheta", "*", "sstheta"}]}]}], ";", "\n", 
             RowBox[{"stheta", "=", 
              RowBox[{
               RowBox[{"Stheta", "*", "cctheta"}], "+", 
               RowBox[{"Ctheta", "*", "sstheta"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"theta", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ctheta", "<", "0"}], "&&", 
                 RowBox[{"stheta", ">", "0"}]}], ",", 
                RowBox[{"Pi", "-", 
                 RowBox[{"ArcSin", "[", "stheta", "]"}]}], ",", 
                RowBox[{"ArcSin", "[", "stheta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"theta", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ctheta", "<", "0"}], "&&", 
                 RowBox[{"stheta", "<", "0"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "Pi"}], "-", 
                 RowBox[{"ArcSin", "[", "stheta", "]"}]}], ",", 
                RowBox[{"ArcSin", "[", "stheta", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "above", " ", "is", " ", "the", " ", "angle", " ", "of", " ", 
               "the", " ", "coupler", " ", "motion", 
               RowBox[{"(", 
                RowBox[{"in", " ", "fixed", " ", "frame"}], ")"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Px", "=", 
              RowBox[{
               RowBox[{"px", "*", "Ctheta"}], "-", 
               RowBox[{"py", "*", "Stheta"}], "+", "R1x"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Py", "=", 
              RowBox[{
               RowBox[{"px", "*", "Stheta"}], "+", 
               RowBox[{"py", "*", "Ctheta"}], "+", "R1y"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"IsP", "=", "1"}], ";", 
             RowBox[{"Xr2", "=", "Xc"}], ";", 
             RowBox[{"Yr2", "=", "Yc"}], ";", 
             RowBox[{"Rr2", "=", "Rc"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Below", " ", "if", " ", "no", " ", "slider", " ", "joint"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IsP", "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"Par1", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad1", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad1", "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], "*", 
                  RowBox[{
                   RowBox[{"dyad1", "[", 
                    RowBox[{"[", "8", "]"}], "]"}], "/", 
                   RowBox[{"dyad1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "^", "2"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Par1", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"Par1", ",", "0.001"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"a1", "/", "a0"}], ",", 
               RowBox[{"a2", "/", "a0"}], ",", 
               RowBox[{"a3", "/", "a0"}], ",", 
               RowBox[{"x1", "/", "x3"}], ",", 
               RowBox[{"x2", "/", "x3"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Par2", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad2", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dyad2", "[", 
                   RowBox[{"[", "5", "]"}], "]"}]}], "/", 
                 RowBox[{"dyad2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], "*", 
                  RowBox[{
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "8", "]"}], "]"}], "/", 
                   RowBox[{"dyad2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "^", "2"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "*", 
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}]}], ")"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"dyad2", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Par2", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"Par2", ",", "0.001"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"a1", "/", "a0"}], ",", 
               RowBox[{"a2", "/", "a0"}], ",", 
               RowBox[{"a3", "/", "a0"}], ",", 
               RowBox[{"x1", "/", "x3"}], ",", 
               RowBox[{"x2", "/", "x3"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Rr1", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Par1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"Par1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{"Par1", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Rr2", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{"Par2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Rr2", ">", "Rr1"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Par", "=", "Par1"}], ";", 
                 RowBox[{"Par1", "=", "Par2"}], ";", 
                 RowBox[{"Par2", "=", "Par"}]}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "choose", " ", "the", " ", "shorter", " ", "one", " ", "to", 
               " ", "be", " ", "crank"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Xr1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"Yr1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", 
             RowBox[{"Rr1", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Par1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"Par1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{"Par1", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Xr2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", 
             RowBox[{"Yr2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", 
             RowBox[{"Rr2", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"Par2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
                RowBox[{"Par2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"x1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ";", 
             RowBox[{"y1", "=", 
              RowBox[{"Par1", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"x2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ";", 
             RowBox[{"y2", "=", 
              RowBox[{"Par2", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"L0", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Xr2", "-", "Xr1"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Yr2", "-", "Yr1"}], ")"}], "^", "2"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"L1", "=", "Rr2"}], ";", 
             RowBox[{"L3", "=", "Rr1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"L2", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"four", " ", "link", " ", "length"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"ctheta0", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Xr1", "-", "Xr2"}], ")"}], "/", "L0"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"stheta0", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Yr1", "-", "Yr2"}], ")"}], "/", "L0"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"theta0", "=", 
              RowBox[{"ArcSin", "[", "stheta0", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"theta0", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ctheta0", "<", "0"}], "&&", 
                 RowBox[{"stheta0", ">", "0"}]}], ",", 
                RowBox[{"Pi", "-", 
                 RowBox[{"ArcSin", "[", "stheta0", "]"}]}], ",", "theta0"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"theta0", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ctheta0", "<", "0"}], "&&", 
                 RowBox[{"stheta0", "<", "0"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "Pi"}], "-", 
                 RowBox[{"ArcSin", "[", "stheta0", "]"}]}], ",", "theta0"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"initial", " ", "angle"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"px", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "x2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}], ")"}]}], 
               "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "y2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}], ")"}]}]}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"py", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "x2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "y2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}], ")"}]}]}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"coupler", " ", "position", " ", "point", 
               RowBox[{"(", 
                RowBox[{"in", " ", "coupler", " ", "moving", " ", "frame"}], 
                ")"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"cctheta", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "/", "L2"}]}], ";", 
             RowBox[{"sstheta", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y2", "-", "y1"}], ")"}], "/", "L2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"coupler", " ", "position", " ", "angle", 
               RowBox[{"(", 
                RowBox[{"in", " ", "coupler", " ", "moving", " ", "frame"}], 
                ")"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                "**", "**", "**", "**", "**", "**"}], "******)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"R1x", "=", 
              RowBox[{"Xr2", "+", 
               RowBox[{"L1", "*", 
                RowBox[{"Cos", "[", 
                 RowBox[{"theta0", "+", "phi"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"R1y", "=", 
              RowBox[{"Yr2", "+", 
               RowBox[{"L1", "*", 
                RowBox[{"Sin", "[", 
                 RowBox[{"theta0", "+", "phi"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "above", " ", "is", " ", "the", " ", "end", " ", "point", " ", 
               "of", " ", "crank"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"L31", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"R1x", "-", "Xr1"}], ")"}], "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"R1y", "-", "Yr1"}], ")"}], "^", "2"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Cbeta", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"L2", "^", "2"}], "+", 
                 RowBox[{"L31", "^", "2"}], "-", 
                 RowBox[{"L3", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", "L31", "*", "L2"}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "\[LessEqual]", "Cbeta", "\[LessEqual]", 
                "1"}], ",", "\n", 
               RowBox[{
                RowBox[{"Sbeta", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"branch", "\[Equal]", "1"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"ArcCos", "[", "Cbeta", "]"}], "]"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"ArcCos", "[", "Cbeta", "]"}], "]"}]}]}], "]"}]}],
                 ";", "\n", "\[IndentingNewLine]", 
                RowBox[{"x22", "=", 
                 RowBox[{"L2", "*", "Cbeta"}]}], ";", 
                RowBox[{"y22", "=", 
                 RowBox[{"L2", "*", "Sbeta"}]}], ";", "\n", 
                RowBox[{"calpha", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Xr1", "-", "R1x"}], ")"}], "/", "L31"}]}], ";", 
                "\n", 
                RowBox[{"salpha", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Yr1", "-", "R1y"}], ")"}], "/", "L31"}]}], ";", 
                "\n", 
                RowBox[{"R11x", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "R1x"}], "*", "calpha"}], "-", 
                  RowBox[{"R1y", "*", "salpha"}]}]}], ";", "\n", 
                RowBox[{"R11y", "=", 
                 RowBox[{
                  RowBox[{"R1x", "*", "salpha"}], "-", 
                  RowBox[{"R1y", "*", "calpha"}]}]}], ";", "\n", 
                RowBox[{"R2x", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x22", "-", "R11x"}], ")"}], "*", "calpha"}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y22", "-", "R11y"}], ")"}], "*", "salpha"}]}]}], 
                ";", "\n", 
                RowBox[{"R2y", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x22", "-", "R11x"}], ")"}], "*", "salpha"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y22", "-", "R11y"}], ")"}], "*", "calpha"}]}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "above", " ", "is", " ", "the", " ", "end", " ", "point", 
                  " ", "of", " ", "rocker"}], "*)"}], "\n", 
                RowBox[{"Ctheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2x", "-", "R1x"}], ")"}], "/", "L2"}]}], ";", 
                "\n", 
                RowBox[{"Stheta", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"R2y", "-", "R1y"}], ")"}], "/", "L2"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "above", " ", "is", " ", "the", " ", "angle", " ", "of", " ",
                   "coupler"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"ctheta", "=", 
                 RowBox[{
                  RowBox[{"Ctheta", "*", "cctheta"}], "-", 
                  RowBox[{"Stheta", "*", "sstheta"}]}]}], ";", "\n", 
                RowBox[{"stheta", "=", 
                 RowBox[{
                  RowBox[{"Stheta", "*", "cctheta"}], "+", 
                  RowBox[{"Ctheta", "*", "sstheta"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"theta", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ctheta", "<", "0"}], "&&", 
                    RowBox[{"stheta", ">", "0"}]}], ",", 
                   RowBox[{"Pi", "-", 
                    RowBox[{"ArcSin", "[", "stheta", "]"}]}], ",", 
                   RowBox[{"ArcSin", "[", "stheta", "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"theta", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ctheta", "<", "0"}], "&&", 
                    RowBox[{"stheta", "<", "0"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "Pi"}], "-", 
                    RowBox[{"ArcSin", "[", "stheta", "]"}]}], ",", 
                   RowBox[{"ArcSin", "[", "stheta", "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "above", " ", "is", " ", "the", " ", "angle", " ", "of", " ",
                   "the", " ", "coupler", " ", "motion", 
                  RowBox[{"(", 
                   RowBox[{"in", " ", "fixed", " ", "frame"}], ")"}]}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Px", "=", 
                 RowBox[{
                  RowBox[{"px", "*", "Ctheta"}], "-", 
                  RowBox[{"py", "*", "Stheta"}], "+", "R1x"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Py", "=", 
                 RowBox[{
                  RowBox[{"px", "*", "Stheta"}], "+", 
                  RowBox[{"py", "*", "Ctheta"}], "+", "R1y"}]}]}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Cbeta", "<", 
                 RowBox[{"-", "1"}]}], "||", 
                RowBox[{"Cbeta", ">", "1"}]}], ",", 
               RowBox[{
                RowBox[{"R2x", "=", "R1x"}], ";", 
                RowBox[{"R2y", "=", "R1y"}], ";", 
                RowBox[{"Px", "=", "R1x"}], ";", 
                RowBox[{"Py", "=", "R1y"}], ";", 
                RowBox[{"theta", "=", "0"}], ";", 
                RowBox[{"flag", "=", "1"}]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "above", " ", "is", " ", "the", " ", "point", " ", "of", " ", 
             "the", " ", "coupler", " ", "motion", 
             RowBox[{"(", 
              RowBox[{"in", " ", "fixed", " ", "frame"}], ")"}]}], "*)"}], 
           "]"}]}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "so", " ", "that", " ", "the", " ", "moving", " ", "frame", " ", 
         "size", " ", "is", " ", "reasonable"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"weight", "=", 
        RowBox[{"view", "*", "20"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pxx", "=", 
        RowBox[{"Px", "+", 
         RowBox[{"weight", "*", 
          RowBox[{"Cos", "[", "theta", "]"}]}]}]}], ";", 
       RowBox[{"Pyx", "=", 
        RowBox[{"Py", "+", 
         RowBox[{"weight", "*", 
          RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "the", " ", "end", " ", "point", " ", "of", " ", "x", " ", "axis", 
         " ", "of", " ", "moving", " ", "frame"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Pxax", "=", 
        RowBox[{"Pxx", "+", 
         RowBox[{"0.25", "*", "weight", "*", 
          RowBox[{"Cos", "[", "theta", "]"}]}]}]}], ";", 
       RowBox[{"Pyax", "=", 
        RowBox[{"Pyx", "+", 
         RowBox[{"0.25", "*", "weight", "*", 
          RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ";", 
       RowBox[{"(*", "arrow", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Pxy", "=", 
        RowBox[{"Px", "+", 
         RowBox[{"weight", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "+", 
            RowBox[{"Pi", "/", "2"}]}], "]"}]}]}]}], ";", 
       RowBox[{"Pyy", "=", 
        RowBox[{"Py", "+", 
         RowBox[{"weight", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"theta", "+", 
            RowBox[{"Pi", "/", "2"}]}], "]"}]}]}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "the", " ", "end", " ", "point", " ", "of", " ", "y", " ", "axis", 
         " ", "of", " ", "moving", " ", "frame"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Pxay", "=", 
        RowBox[{"Pxy", "+", 
         RowBox[{"0.25", "*", "weight", "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "+", 
            RowBox[{"Pi", "/", "2"}]}], "]"}]}]}]}], ";", 
       RowBox[{"Pyay", "=", 
        RowBox[{"Pyy", "+", 
         RowBox[{"0.25", "*", "weight", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"theta", "+", 
            RowBox[{"Pi", "/", "2"}]}], "]"}]}]}]}], ";", 
       RowBox[{"(*", "arrow", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Below", " ", "plot", " ", "the", " ", "four", " ", "bar"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"barL0", "=", 
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xr2", ",", "Yr2", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xr1", ",", "Yr1", ",", "0"}], "}"}]}], "}"}], ",", 
            "0.05"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"barL1", "=", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Xr2", ",", "Yr2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"R1x", ",", "R1y"}], "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"shaft1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Xr2", ",", "Yr2"}], "}"}], ",", "view"}], "]"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"shaft1a", "=", 
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xr2", ",", "Yr2", ",", 
                RowBox[{"-", "0.05"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Xr2", ",", "Yr2", ",", "0.05"}], "}"}]}], "}"}], ",", 
            "0.3"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pivot1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"R1x", ",", "R1y"}], "}"}], ",", 
            RowBox[{"1", "*", "view"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"pivot1a", "=", 
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"R1x", ",", "R1y", ",", "0.15"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"R1x", ",", "R1y", ",", "0.35"}], "}"}]}], "}"}], ",", 
            "0.1"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"input", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Xr2", ",", "Yr2"}], "}"}], ",", "Rr2"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsP", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"barL3", "=", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Xr1", ",", "Yr1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"R2x", ",", "R2y"}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"flag", "\[Equal]", "1"}], ",", 
            RowBox[{"barL3", "=", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Xr1", ",", "Yr1"}], "}"}], ",", "view"}], "]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"shaft2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Xr1", ",", "Yr1"}], "}"}], ",", 
               RowBox[{"1", "*", "view"}]}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"shaft2a", "=", 
             RowBox[{"Cylinder", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Xr1", ",", "Yr1", ",", 
                   RowBox[{"-", "0.05"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Xr1", ",", "Yr1", ",", "0.05"}], "}"}]}], "}"}], 
               ",", "0.3"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pivot2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"R2x", ",", "R2y"}], "}"}], ",", 
               RowBox[{"1", "*", "view"}]}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"pivot2a", "=", 
             RowBox[{"Cylinder", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"R2x", ",", "R2y", ",", "0.15"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"R2x", ",", "R2y", ",", "0.35"}], "}"}]}], "}"}], 
               ",", "0.1"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Xr1", ",", "Yr1"}], "}"}], ",", "Rr1"}], "}"}]}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsP", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"pivot2", "=", 
            RowBox[{"Cylinder", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"R2x", ",", "R2y", ",", "0.05"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"R2x", ",", "R2y", ",", "0.15"}], "}"}]}], "}"}], 
              ",", "0.2"}], "]"}]}], "*)"}], 
          RowBox[{"pivot2", "=", "pivot1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"pivot2a", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"R2x", ",", "R2y"}], "}"}], ",", 
               RowBox[{"1", "*", "view"}]}], "]"}]}], "}"}]}], ";", 
          RowBox[{"barL3", "=", "barL1"}], ";", 
          RowBox[{"shaft2a", "=", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "10"}], "-", 
                 RowBox[{"0.05", "*", 
                  RowBox[{"a", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}], ",", 
                RowBox[{
                 RowBox[{"10", 
                  RowBox[{"a", "/", "b"}]}], "-", 
                 RowBox[{"c", "/", "b"}], "-", 
                 RowBox[{"0.05", "*", 
                  RowBox[{"b", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"10", "+", 
                 RowBox[{"0.05", "*", 
                  RowBox[{"a", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "10"}], 
                  RowBox[{"a", "/", "b"}]}], "-", 
                 RowBox[{"c", "/", "b"}], "+", 
                 RowBox[{"0.05", "*", 
                  RowBox[{"b", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}]}], "}"}]}], "}"}], 
            "]"}]}], ";", 
          RowBox[{"shaft2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R2x", "-", 
                  RowBox[{"0.1", "*", 
                   RowBox[{"b", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}], ",", 
                 RowBox[{"R2y", "+", 
                  RowBox[{"0.1", 
                   RowBox[{"a", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"a", "^", "2"}], "+", 
                    RowBox[{"b", "^", "2"}]}], "]"}]}]}]}]}], "}"}], ",", 
               "view"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"b", "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"shaft2a", "=", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"c", "/", "a"}], "-", "0.05"}], ",", 
                   RowBox[{"-", "10"}], ",", 
                   RowBox[{"-", "0.05"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"c", "/", "a"}], "+", "0.05"}], ",", "10", ",", 
                   "0.05"}], "}"}]}], "}"}], "]"}]}], ";", 
             RowBox[{"shaft2", "=", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R2x", "-", "0.1"}], ",", 
                  RowBox[{"R2y", "-", "0.1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"R2x", "+", "0.1"}], ",", 
                  RowBox[{"R2y", "+", "0.1"}]}], "}"}]}], "]"}]}]}]}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"barL2", "=", 
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"R1x", ",", "R1y", ",", "0.3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"R2x", ",", "R2y", ",", "0.3"}], "}"}]}], "}"}], ",", 
            "0.05"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"drawPoses", "[", 
        RowBox[{"xInput", ",", "yInput", ",", "\[Theta]Input", ",", 
         RowBox[{"Length", "[", "xInput", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"movingBody", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
          RowBox[{"Triangle", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"R1x", ",", "R1y"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"R2x", ",", "R2y"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Px", ",", "Py"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"moving1", "=", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R1x", ",", "R1y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Px", ",", "Py"}], "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"moving2", "=", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R2x", ",", "R2y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Px", ",", "Py"}], "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"movingpoint", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", " ", "[", "0.01", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"Px", ",", "Py"}], "}"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"movingX", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Px", ",", "Py"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Pxx", ",", "Pyx"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"movingY", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Arrowheads", "[", ".05", "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Px", ",", "Py"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Pxy", ",", "Pyy"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mechanism", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fixedFrame", ",", "posesFrame", ",", 
            RowBox[{"(*", 
             RowBox[{"constraints", ","}], "*)"}], 
            RowBox[{"{", 
             RowBox[{"Purple", ",", 
              RowBox[{"Specularity", "[", "0.5", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.7", "]"}], ",", "movingBody"}], 
             "}"}], ",", "movingpoint", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"RGBColor", "[", 
               RowBox[{"0.28", ",", "0.67", ",", "0.5"}], "]"}], ",", 
              "movingX", ",", "movingY"}], "}"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", "movingFrame"}], "}"}], ",", "origin", ",", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "fixFrame"}], "}"}]}], "*)"}], 
            RowBox[{"{", 
             RowBox[{"Yellow", ",", "pivot2", ",", "pivot1"}], "}"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Purple", ",", "pivot1a", ",", "pivot2a"}], "}"}], 
              ","}], "*)"}], 
            RowBox[{"{", 
             RowBox[{"Green", ",", "shaft1", ",", "shaft2"}], "}"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", "shaft2a", ",", "shaft1a"}], "}"}], ","}], 
             "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              RowBox[{"Specularity", "[", "0.8", "]"}], ",", "barL1", ",", 
              "barL3"}], "}"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"300", ",", "300"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"(*", "Automatic", "*)"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "100"}], "*", "view"}], ",", 
               RowBox[{"100", "*", "view"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "100"}], "*", "view"}], ",", 
               RowBox[{"100", "*", "view"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"mechanism", ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "100"}], "*", "view"}], ",", 
                 RowBox[{"100", "*", "view"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "100"}], "*", "view"}], ",", 
                 RowBox[{"100", "*", "view"}]}], "}"}]}], "}"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Spacer", "[", "200", "]"}], ",", 
             RowBox[{"Text", "[", 
              RowBox[{"Grid", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Crank Dyad\>\"", ",", "Large"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"input", ",", "Large"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Output Dyad\>\"", ",", "Large"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"output", ",", "Large"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Moving Pivot 1\>\"", ",", "Large"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x2", ",", "y2"}], "}"}], ",", "Large"}], "]"}]}],
                    "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Moving Pivot 2\>\"", ",", "Large"}], "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "y1"}], "}"}], ",", "Large"}], "]"}]}],
                    "}"}]}], "}"}], ",", 
                RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}]}], "}"}], 
           "]"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"branch", ",", "2", ",", "\"\<branch\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<1\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<2\>\""}]}], "}"}], ",", "Setter"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"phi", ",", "0", ",", "\"\<rotate\>\""}], "}"}], ",", "0", 
        ",", 
        RowBox[{"2", "Pi"}], ",", "0.01", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"view", ",", "0.3", ",", "\"\<view range\>\""}], "}"}], ",", 
        "0.01", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TrackedSymbols", "\[Rule]", "Manipulate"}], ",", 
      RowBox[{"AutorunSequencing", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "}"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.682878536101599*^9, 3.682878536937993*^9}, {
   3.6828785959547524`*^9, 3.6828785966169453`*^9}, {3.6828787361655493`*^9, 
   3.68287884749636*^9}, {3.6828791551070786`*^9, 3.6828791567041593`*^9}, {
   3.682879220936721*^9, 3.6828792253044157`*^9}, 3.6828792931021633`*^9, 
   3.6828793561749105`*^9, 3.6828794320341363`*^9, {3.6828794953955603`*^9, 
   3.682879516767023*^9}, {3.6829469316672707`*^9, 3.682946932873044*^9}, {
   3.6829469664447327`*^9, 3.682947065077689*^9}, {3.682948297633164*^9, 
   3.6829483006967926`*^9}, {3.6829492381064544`*^9, 3.682949246206563*^9}, {
   3.6829492842838707`*^9, 3.682949337096093*^9}, {3.6829497021281023`*^9, 
   3.6829497029126835`*^9}, 3.6829497405245876`*^9, {3.682949784866567*^9, 
   3.682949785197523*^9}, {3.682955507699856*^9, 3.6829555288954244`*^9}, {
   3.6829555669709992`*^9, 3.682955595132331*^9}, {3.682955633543931*^9, 
   3.6829556951340237`*^9}, {3.6829558698919744`*^9, 
   3.6829559780776567`*^9}, {3.6829560699506674`*^9, 
   3.6829561688975763`*^9}, {3.6829562120660577`*^9, 3.682956246839965*^9}, {
   3.682956288899682*^9, 3.68295637456046*^9}, 3.6829565712002234`*^9, {
   3.682956675529825*^9, 3.682956717501053*^9}, 3.6829567709268684`*^9, {
   3.682956867957242*^9, 3.682956871024898*^9}, {3.68295707972968*^9, 
   3.682957080310361*^9}, {3.68295718988214*^9, 3.682957226648289*^9}, {
   3.682957319182538*^9, 3.6829573457065554`*^9}, {3.68295738017997*^9, 
   3.682957409164493*^9}, {3.6829661370856996`*^9, 3.682966137271165*^9}, 
   3.6829663130527344`*^9, {3.6829663512927547`*^9, 3.682966410422847*^9}, {
   3.682966447487735*^9, 3.6829664865006886`*^9}, {3.682966600422558*^9, 
   3.682966603353526*^9}, {3.6829666955462255`*^9, 3.6829666999300613`*^9}, {
   3.682966741284667*^9, 3.6829667775767174`*^9}, {3.682966863766387*^9, 
   3.682966915613325*^9}, {3.6829669623954105`*^9, 3.6829669686798096`*^9}, {
   3.682967000985482*^9, 3.68296700278519*^9}, {3.682967321084318*^9, 
   3.682967326118909*^9}, {3.6829674786173663`*^9, 3.6829674900824547`*^9}, {
   3.682967596550061*^9, 3.6829676477196217`*^9}, {3.682967692056182*^9, 
   3.6829677554670362`*^9}, 3.682967790347417*^9, {3.6829678734065523`*^9, 
   3.6829678876235666`*^9}, {3.682967938394559*^9, 3.6829679859516277`*^9}, {
   3.6829683652440753`*^9, 3.682968446638627*^9}, {3.6829685000435095`*^9, 
   3.6829685224413977`*^9}, {3.6829692138464384`*^9, 
   3.6829692930103025`*^9}, {3.6829693524840455`*^9, 
   3.6829693834419293`*^9}, {3.6829694494846168`*^9, 3.682969473644178*^9}, {
   3.682969582912448*^9, 3.6829695963231354`*^9}, {3.682969811869342*^9, 
   3.6829698172040997`*^9}, {3.6829700486935916`*^9, 3.682970079937324*^9}, {
   3.682971105440279*^9, 3.682971109219602*^9}, {3.682971193055461*^9, 
   3.6829712583847466`*^9}, {3.6829713117774687`*^9, 3.682971315675467*^9}, {
   3.682971364489955*^9, 3.682971431270746*^9}, {3.6829714828126454`*^9, 
   3.682971488841691*^9}, {3.6829715743636975`*^9, 3.6829715764798837`*^9}, {
   3.682980228105547*^9, 3.6829802689362097`*^9}, {3.682980300085325*^9, 
   3.6829803153403735`*^9}, {3.6829803822078447`*^9, 
   3.6829803842294483`*^9}, {3.6829861569632387`*^9, 
   3.6829861624604177`*^9}, {3.682988868378538*^9, 3.6829888687098875`*^9}, {
   3.682988960643983*^9, 3.6829889825730095`*^9}, {3.694290318777746*^9, 
   3.694290330719449*^9}, {3.694291288369885*^9, 3.694291292489243*^9}, 
   3.6942916329829483`*^9, 3.694291764681767*^9, {3.694291824024626*^9, 
   3.694291866358777*^9}, {3.694291911597722*^9, 3.6942919176179457`*^9}, {
   3.694292101885188*^9, 3.694292141021446*^9}, 3.694292343891131*^9, {
   3.694292381471211*^9, 3.694292400492696*^9}, {3.694292442033668*^9, 
   3.6942924753964043`*^9}, 3.6942933683679733`*^9, {3.6942938152471457`*^9, 
   3.694293817538763*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", " ", "=", " ", 
   RowBox[{"Import", "[", "f", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getPoses", "[", "file", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyad", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fourbarSynthesis", "[", 
   RowBox[{"xInput", ",", "yInput", ",", "\[Theta]Input"}], "]"}], 
  ";"}], "\[IndentingNewLine]", "dyad"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.68717065162449*^9, 3.687170673732293*^9}, 
   3.687170925007102*^9, {3.687171054055688*^9, 3.6871710562700787`*^9}, {
   3.687171197995988*^9, 3.6871711984489594`*^9}, 3.687171480854373*^9, {
   3.687171598086445*^9, 3.6871716567796917`*^9}, {3.687171727357864*^9, 
   3.6871718098360243`*^9}, {3.6882625472551365`*^9, 3.688262571346162*^9}, {
   3.6882626427007895`*^9, 3.688262665557736*^9}, {3.688262698289051*^9, 
   3.6882627327536154`*^9}, {3.6882627822642517`*^9, 3.6882628656215653`*^9}, 
   3.6882630013833885`*^9, {3.694221968882454*^9, 3.694221998020948*^9}, {
   3.694222042959497*^9, 3.6942220445151567`*^9}, {3.694222089870079*^9, 
   3.694222107928484*^9}, {3.694222139461578*^9, 3.694222151554002*^9}, {
   3.694222192776078*^9, 3.694222207068775*^9}, {3.694222298283305*^9, 
   3.694222306444601*^9}, {3.694223029159767*^9, 3.694223102590782*^9}, {
   3.6942233123081417`*^9, 3.694223317955036*^9}, {3.6942236261210833`*^9, 
   3.694223645189695*^9}, 3.694223764394793*^9, {3.694223901711154*^9, 
   3.694223920595922*^9}, 3.694224620114853*^9, {3.6942262052512407`*^9, 
   3.694226345998345*^9}, {3.694226881364403*^9, 3.694226931247387*^9}, {
   3.694226982793419*^9, 3.694227023316902*^9}, {3.694227679961121*^9, 
   3.694227713291545*^9}, {3.694227806934926*^9, 3.694227808096527*^9}, {
   3.694259950863654*^9, 3.6942600112441683`*^9}, {3.6942627571811457`*^9, 
   3.694262774087846*^9}, {3.6942683521483793`*^9, 3.694268362647653*^9}, {
   3.694268499705079*^9, 3.694268500132173*^9}, {3.694268657947878*^9, 
   3.694268700606089*^9}, {3.694268747016679*^9, 3.694268760816003*^9}, {
   3.694268807664809*^9, 3.694268831559209*^9}, {3.6942690182827044`*^9, 
   3.694269022768076*^9}, {3.694269073618709*^9, 3.694269081101925*^9}, {
   3.6942903636914062`*^9, 3.694290388811254*^9}, 3.694294147438697*^9, {
   3.694295684845663*^9, 3.694295794419756*^9}, 3.6942960486029243`*^9, {
   3.694296293858704*^9, 3.694296303517789*^9}, 3.6942963768205557`*^9, {
   3.694296498901741*^9, 3.694296521272085*^9}, 3.6943153658369913`*^9, 
   3.694315467829266*^9, {3.69635515372712*^9, 3.6963551847854443`*^9}, {
   3.696363132332782*^9, 3.696363134713501*^9}, {3.6963631737146053`*^9, 
   3.696363194999816*^9}, {3.696363272822667*^9, 3.696363282493979*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08880076081521111`"}], ",", "0.0834457773083382`", ",", 
     "0.3354068674376002`", ",", 
     RowBox[{"-", "0.3902194731465648`"}], ",", 
     RowBox[{"-", "0.44058601084457594`"}], ",", "1.059869848986844`", ",", 
     "1.0154065085492048`", ",", "0.5811578168914531`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0926011291322454`"}], ",", "0.171317454567052`", ",", 
     RowBox[{"-", "0.1508731497769209`"}], ",", "0.023651999571240867`", ",", 
     "0.4555705027921928`", ",", "0.8813675529967799`", ",", 
     "0.3492471255257322`", ",", "0.4648607452190713`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.696363720345358*^9, 3.696363902602717*^9, 
  3.696364491522724*^9, 3.6963645221227293`*^9, 3.6967158228825493`*^9, 
  3.6967159818684053`*^9, 3.6967164492318773`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimulateMechanism", "[", 
  RowBox[{
   RowBox[{"dyad", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"dyad", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.694290401619936*^9, 3.694290447088867*^9}, 
   3.6942904792253237`*^9, {3.694291390062417*^9, 3.6942913914153852`*^9}, {
   3.694291423513249*^9, 3.694291438486232*^9}, 3.694291995363991*^9, {
   3.6942937337073727`*^9, 3.694293736657494*^9}, {3.694293810653644*^9, 
   3.694293830749599*^9}, {3.694293897984799*^9, 3.694293900807948*^9}, {
   3.694294171067093*^9, 3.6942941738141937`*^9}, {3.69431566268132*^9, 
   3.694315664705649*^9}, {3.694351104984641*^9, 3.694351108689621*^9}, {
   3.694389454513502*^9, 3.694389456679863*^9}, 3.694437434139172*^9, {
   3.694437496926566*^9, 3.694437513189063*^9}, {3.694437567695071*^9, 
   3.694437570274407*^9}, {3.6963551734700403`*^9, 3.696355178394889*^9}, {
   3.696364100384544*^9, 3.696364100924902*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`branch$$ = 2, $CellContext`phi$$ = 
    4.66, $CellContext`view$$ = 0.125, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`branch$$], 2, "branch"}, {1 -> "1", 2 -> "2"}}, {{
       Hold[$CellContext`phi$$], 0, "rotate"}, 0, 2 Pi, 0.01}, {{
       Hold[$CellContext`view$$], 0.3, "view range"}, 0.01, 1}}, 
    Typeset`size$$ = {956., {147., 153.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`branch$12016$$ = False, $CellContext`phi$12017$$ = 
    0, $CellContext`view$12018$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`branch$$ = 2, $CellContext`phi$$ = 
        0, $CellContext`view$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`branch$$, $CellContext`branch$12016$$, False], 
        Hold[$CellContext`phi$$, $CellContext`phi$12017$$, 0], 
        Hold[$CellContext`view$$, $CellContext`view$12018$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`weight = 1; $CellContext`Flag = 1; 
       If[$CellContext`Flag == 
         0, {$CellContext`Xr1 = 0, $CellContext`Xr2 = 0, $CellContext`Rr1 = 
          0, $CellContext`Xr2 = 0, $CellContext`Yr2 = 0, $CellContext`Rr2 = 
          0, $CellContext`x1 = 0, $CellContext`y1 = 0, $CellContext`x2 = 
          0, $CellContext`y2 = 0, $CellContext`R1x = 0, $CellContext`R1y = 
          0, $CellContext`R2x = 0, $CellContext`R2y = 0, $CellContext`Px = 
          0, $CellContext`Py = 0, $CellContext`theta = 0, $CellContext`weight = 
          0}]; If[$CellContext`Flag == 
         1, {-0.08880076081521111, 0.0834457773083382, 
           0.3354068674376002, -0.3902194731465648, -0.44058601084457594`, 
           1.059869848986844, 1.0154065085492048`, 
           0.5811578168914531} = {-0.08880076081521111, 0.0834457773083382, 
            0.3354068674376002, -0.3902194731465648, -0.44058601084457594`, 
            1.059869848986844, 1.0154065085492048`, 0.5811578168914531}/
           Norm[{-0.08880076081521111, 0.0834457773083382, 
            0.3354068674376002, -0.3902194731465648, -0.44058601084457594`, 
            1.059869848986844, 1.0154065085492048`, 
            0.5811578168914531}]; {-0.0926011291322454, 
           0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
           0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
           0.4648607452190713} = {-0.0926011291322454, 
            0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
            0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
            0.4648607452190713}/
           Norm[{-0.0926011291322454, 0.171317454567052, -0.1508731497769209, 
            0.023651999571240867`, 0.4555705027921928, 0.8813675529967799, 
            0.3492471255257322, 0.4648607452190713}]; $CellContext`IsP = 0; If[
           Or[
            And[Abs[
               
               Part[{-0.08880076081521111, 0.0834457773083382, 
                0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                0.5811578168914531}, 1]] < 0.03, Abs[
               
               Part[{-0.08880076081521111, 0.0834457773083382, 
                0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                0.5811578168914531}, 2]] < 0.03, Abs[
               
               Part[{-0.08880076081521111, 0.0834457773083382, 
                0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                0.5811578168914531}, 3]] < 0.03], 
            And[Abs[
               
               Part[{-0.0926011291322454, 
                0.171317454567052, -0.1508731497769209, 0.023651999571240867`,
                 0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
                0.4648607452190713}, 1]] < 0.03, Abs[
               
               Part[{-0.0926011291322454, 
                0.171317454567052, -0.1508731497769209, 0.023651999571240867`,
                 0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
                0.4648607452190713}, 2]] < 0.03, Abs[
               
               Part[{-0.0926011291322454, 
                0.171317454567052, -0.1508731497769209, 0.023651999571240867`,
                 0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
                0.4648607452190713}, 3]] < 0.03]], If[
             Abs[
              And[
              Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 1] < 0.03, Abs[
                 
                 Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   2]] < 0.03, Abs[
                 
                 Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   3]] < 0.03]], $CellContext`dyado = {-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713}; {-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713} = {-0.08880076081521111, 
               0.0834457773083382, 
               0.3354068674376002, -0.3902194731465648, -0.44058601084457594`,
                1.059869848986844, 1.0154065085492048`, 
               0.5811578168914531}; {-0.08880076081521111, 0.0834457773083382,
                0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
               0.5811578168914531} = $CellContext`dyado]; $CellContext`Par2 = \
{(-Part[{-0.0926011291322454, 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4])/Part[{-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713}, 1], (-
               Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5])/Part[{-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713}, 
               1], (-4) (
                Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   8]/Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 1]) + (Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 6]^2 + 
                4 Part[{-0.0926011291322454, 
                    0.171317454567052, -0.1508731497769209, 
                    0.023651999571240867`, 0.4555705027921928, 
                    0.8813675529967799, 0.3492471255257322, 
                    0.4648607452190713}, 7]^2)/(
               Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   4]^2 + Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   5]^2), (
               Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   6] 
                Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   5] - 2 
               Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 7] Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4])/(Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4]^2 + Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5]^2), (-(
                Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 6] 
                 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 4] + 
                2 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 7] 
                 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 5]))/(
              Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4]^2 + Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5]^2)}; $CellContext`Par2 = 
            Round[$CellContext`Par2, 0.001]; $CellContext`Xc = 
            Part[$CellContext`Par2, 1]; $CellContext`Yc = 
            Part[$CellContext`Par2, 2]; $CellContext`Rc = 
            Sqrt[Part[$CellContext`Par2, 1]^2 + Part[$CellContext`Par2, 2]^2 + 
              Part[$CellContext`Par2, 3]]; $CellContext`x2 = 
            Part[$CellContext`Par2, 4]; $CellContext`y2 = 
            Part[$CellContext`Par2, 5]; $CellContext`Par1 = {
              
              Part[{-0.08880076081521111, 0.0834457773083382, 
               0.3354068674376002, -0.3902194731465648, -0.44058601084457594`,
                1.059869848986844, 1.0154065085492048`, 0.5811578168914531}, 
               4], 
              
              Part[{-0.08880076081521111, 0.0834457773083382, 
               0.3354068674376002, -0.3902194731465648, -0.44058601084457594`,
                1.059869848986844, 1.0154065085492048`, 0.5811578168914531}, 
               5], 4 Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 8] - 
              Part[{-0.08880076081521111, 0.0834457773083382, 
                0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                0.5811578168914531}, 1] ((
                Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 6]^2 + 
                4 Part[{-0.08880076081521111, 0.0834457773083382, 
                    0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                    0.5811578168914531}, 7]^2)/(
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 4]^2 + 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 5]^2)), (
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 6] 
                Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 5] - 2 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 7] 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4])/(
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4]^2 + 
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 5]^2), (-(
                Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 6] 
                 Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 4] + 
                2 Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 7] 
                 Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 5]))/(
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4]^2 + 
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 5]^2)}; $CellContext`Par1 = 
            Round[$CellContext`Par1, 0.001]; $CellContext`a = 
            2 Part[$CellContext`Par1, 1]; $CellContext`b = 
            2 Part[$CellContext`Par1, 2]; $CellContext`c = 
            Part[$CellContext`Par1, 3]; $CellContext`x1 = 
            Part[$CellContext`Par1, 4]; $CellContext`y1 = 
            Part[$CellContext`Par1, 5]; $CellContext`L = 
            Sqrt[($CellContext`x1 - $CellContext`x2)^2 + ($CellContext`y1 - \
$CellContext`y2)^2]; $CellContext`L2 = $CellContext`L; $CellContext`px = \
(-$CellContext`x2) (($CellContext`x1 - $CellContext`x2)/$CellContext`L2) - \
(-$CellContext`y2) (($CellContext`y2 - $CellContext`y1)/$CellContext`L2); \
$CellContext`py = (-$CellContext`x2) (($CellContext`y2 - \
$CellContext`y1)/$CellContext`L2) + (-$CellContext`y2) (($CellContext`x1 - \
$CellContext`x2)/$CellContext`L2); $CellContext`cctheta = ($CellContext`x1 - \
$CellContext`x2)/$CellContext`L2; $CellContext`sstheta = ($CellContext`y2 - \
$CellContext`y1)/$CellContext`L2; 
           If[$CellContext`b == 
             0, $CellContext`R1x = $CellContext`Xc + $CellContext`Rc 
                Cos[$CellContext`phi$$]; $CellContext`R1y = $CellContext`Yc + \
$CellContext`Rc 
                Sin[$CellContext`phi$$]; $CellContext`Cc = \
(-$CellContext`c)/$CellContext`a; $CellContext`R2x = $CellContext`Cc; \
$CellContext`R2y = 
              If[$CellContext`branch$$ == 1, $CellContext`R1y - 
                Sqrt[$CellContext`L^2 - ($CellContext`R1x - \
$CellContext`Cc)^2], $CellContext`R1y + 
                Sqrt[$CellContext`L^2 - ($CellContext`R1x - \
$CellContext`Cc)^2]]; $CellContext`Ctheta = ($CellContext`R2x - \
$CellContext`R1x)/$CellContext`L; $CellContext`Stheta = ($CellContext`R2y - \
$CellContext`R1y)/$CellContext`L; 
             If[$CellContext`L^2 - ($CellContext`R1x - $CellContext`Cc)^2 < 
               0, $CellContext`R2x = $CellContext`R1x; $CellContext`R2y = \
$CellContext`R1y; $CellContext`Ctheta = 1; $CellContext`Stheta = 
                0; $CellContext`flag = 1]]; 
           If[$CellContext`b != 
             0, $CellContext`R1x = $CellContext`Xc + $CellContext`Rc 
                Cos[$CellContext`phi$$]; $CellContext`R1y = $CellContext`Yc + \
$CellContext`Rc Sin[$CellContext`phi$$]; 
             K = (-$CellContext`a)/$CellContext`b; $CellContext`Cc = \
(-$CellContext`c)/$CellContext`b; $CellContext`AA = 
              1 + K^2; $CellContext`BB = -(2 $CellContext`R1x - 2 
                K $CellContext`Cc + 
                2 $CellContext`R1y 
                 K); $CellContext`CC = $CellContext`R1x^2 + $CellContext`Cc^2 + \
$CellContext`R1y^2 - $CellContext`L^2 - 
               2 $CellContext`R1y $CellContext`Cc; $CellContext`R2x = 
              If[$CellContext`branch$$ == 
                1, (-$CellContext`BB - 
                 Sqrt[$CellContext`BB^2 - 
                  4 $CellContext`AA $CellContext`CC])/(
                2 $CellContext`AA), (-$CellContext`BB + 
                 Sqrt[$CellContext`BB^2 - 
                   4 $CellContext`AA $CellContext`CC])/(
                2 $CellContext`AA)]; $CellContext`R2y = 
              K $CellContext`R2x + $CellContext`Cc; $CellContext`Ctheta = \
($CellContext`R2x - $CellContext`R1x)/$CellContext`L; $CellContext`Stheta = \
($CellContext`R2y - $CellContext`R1y)/$CellContext`L; 
             If[$CellContext`BB^2 - 4 $CellContext`AA $CellContext`CC < 
               0, $CellContext`R2x = $CellContext`R1x; $CellContext`R2y = \
$CellContext`R1y; $CellContext`Ctheta = 1; $CellContext`Stheta = 
                0; $CellContext`flag = 
                1]]; $CellContext`ctheta = $CellContext`Ctheta \
$CellContext`cctheta - $CellContext`Stheta $CellContext`sstheta; \
$CellContext`stheta = $CellContext`Stheta $CellContext`cctheta + \
$CellContext`Ctheta $CellContext`sstheta; $CellContext`theta = If[
              And[$CellContext`ctheta < 0, $CellContext`stheta > 0], Pi - 
              ArcSin[$CellContext`stheta], 
              ArcSin[$CellContext`stheta]]; $CellContext`theta = If[
              And[$CellContext`ctheta < 0, $CellContext`stheta < 0], -Pi - 
              ArcSin[$CellContext`stheta], 
              
              ArcSin[$CellContext`stheta]]; $CellContext`Px = $CellContext`px \
$CellContext`Ctheta - $CellContext`py $CellContext`Stheta + $CellContext`R1x; \
$CellContext`Py = $CellContext`px $CellContext`Stheta + $CellContext`py \
$CellContext`Ctheta + $CellContext`R1y; $CellContext`IsP = 
            1; $CellContext`Xr2 = $CellContext`Xc; $CellContext`Yr2 = \
$CellContext`Yc; $CellContext`Rr2 = $CellContext`Rc]; 
         If[$CellContext`IsP == 
           0, $CellContext`Par1 = {(-
               Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4])/
              Part[{-0.08880076081521111, 0.0834457773083382, 
               0.3354068674376002, -0.3902194731465648, -0.44058601084457594`,
                1.059869848986844, 1.0154065085492048`, 0.5811578168914531}, 
               1], (-Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 5])/
              Part[{-0.08880076081521111, 0.0834457773083382, 
               0.3354068674376002, -0.3902194731465648, -0.44058601084457594`,
                1.059869848986844, 1.0154065085492048`, 0.5811578168914531}, 
               1], (-4) (
                Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 8]/
                Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 1]) + (
                Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 6]^2 + 
                4 Part[{-0.08880076081521111, 0.0834457773083382, 
                    0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                    0.5811578168914531}, 7]^2)/(
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 4]^2 + 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 5]^2), (
               Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 6] 
                Part[{-0.08880076081521111, 0.0834457773083382, 
                  0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                  0.5811578168914531}, 5] - 2 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 7] 
               Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4])/(
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4]^2 + 
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 5]^2), (-(
                Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 6] 
                 Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 4] + 
                2 Part[{-0.08880076081521111, 0.0834457773083382, 
                   
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 7] 
                 Part[{-0.08880076081521111, 0.0834457773083382, 
                   0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                   0.5811578168914531}, 5]))/(
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 4]^2 + 
              Part[{-0.08880076081521111, 0.0834457773083382, 
                 0.3354068674376002, -0.3902194731465648, \
-0.44058601084457594`, 1.059869848986844, 1.0154065085492048`, 
                 0.5811578168914531}, 5]^2)}; $CellContext`Par1 = 
            Round[$CellContext`Par1, 
              0.001]; $CellContext`Par2 = {(-
               Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4])/Part[{-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713}, 1], (-
               Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5])/Part[{-0.0926011291322454, 
               0.171317454567052, -0.1508731497769209, 0.023651999571240867`, 
               0.4555705027921928, 0.8813675529967799, 0.3492471255257322, 
               0.4648607452190713}, 
               1], (-4) (
                Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   8]/Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 1]) + (Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 6]^2 + 
                4 Part[{-0.0926011291322454, 
                    0.171317454567052, -0.1508731497769209, 
                    0.023651999571240867`, 0.4555705027921928, 
                    0.8813675529967799, 0.3492471255257322, 
                    0.4648607452190713}, 7]^2)/(
               Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   4]^2 + Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   5]^2), (
               Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   6] Part[{-0.0926011291322454, 
                  0.171317454567052, -0.1508731497769209, 
                  0.023651999571240867`, 0.4555705027921928, 
                  0.8813675529967799, 0.3492471255257322, 0.4648607452190713},
                   5] - 2 
               Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 7] Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4])/(Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4]^2 + Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5]^2), (-(
                Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 6] 
                 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 4] + 
                2 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 7] 
                 Part[{-0.0926011291322454, 
                   0.171317454567052, -0.1508731497769209, 
                   0.023651999571240867`, 0.4555705027921928, 
                   0.8813675529967799, 0.3492471255257322, 
                   0.4648607452190713}, 5]))/(
              Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 4]^2 + Part[{-0.0926011291322454, 
                 0.171317454567052, -0.1508731497769209, 
                 0.023651999571240867`, 0.4555705027921928, 
                 0.8813675529967799, 0.3492471255257322, 0.4648607452190713}, 
                 5]^2)}; $CellContext`Par2 = 
            Round[$CellContext`Par2, 0.001]; $CellContext`Rr1 = 
            Sqrt[Part[$CellContext`Par1, 1]^2 + Part[$CellContext`Par1, 2]^2 + 
              Part[$CellContext`Par1, 3]]; $CellContext`Rr2 = 
            Sqrt[Part[$CellContext`Par2, 1]^2 + Part[$CellContext`Par2, 2]^2 + 
              Part[$CellContext`Par2, 3]]; 
           If[$CellContext`Rr2 > $CellContext`Rr1, {$CellContext`Par = \
$CellContext`Par1; $CellContext`Par1 = $CellContext`Par2; $CellContext`Par2 = \
$CellContext`Par}]; $CellContext`Xr1 = 
            Part[$CellContext`Par1, 1]; $CellContext`Yr1 = 
            Part[$CellContext`Par1, 2]; $CellContext`Rr1 = 
            Sqrt[Part[$CellContext`Par1, 1]^2 + Part[$CellContext`Par1, 2]^2 + 
              Part[$CellContext`Par1, 3]]; $CellContext`Xr2 = 
            Part[$CellContext`Par2, 1]; $CellContext`Yr2 = 
            Part[$CellContext`Par2, 2]; $CellContext`Rr2 = 
            Sqrt[Part[$CellContext`Par2, 1]^2 + Part[$CellContext`Par2, 2]^2 + 
              Part[$CellContext`Par2, 3]]; $CellContext`x1 = 
            Part[$CellContext`Par1, 4]; $CellContext`y1 = 
            Part[$CellContext`Par1, 5]; $CellContext`x2 = 
            Part[$CellContext`Par2, 4]; $CellContext`y2 = 
            Part[$CellContext`Par2, 5]; $CellContext`L0 = 
            Sqrt[($CellContext`Xr2 - $CellContext`Xr1)^2 + ($CellContext`Yr2 - \
$CellContext`Yr1)^2]; $CellContext`L1 = $CellContext`Rr2; $CellContext`L3 = \
$CellContext`Rr1; $CellContext`L2 = 
            Sqrt[($CellContext`x1 - $CellContext`x2)^2 + ($CellContext`y1 - \
$CellContext`y2)^2]; $CellContext`ctheta0 = ($CellContext`Xr1 - \
$CellContext`Xr2)/$CellContext`L0; $CellContext`stheta0 = ($CellContext`Yr1 - \
$CellContext`Yr2)/$CellContext`L0; $CellContext`theta0 = 
            ArcSin[$CellContext`stheta0]; $CellContext`theta0 = If[
              And[$CellContext`ctheta0 < 0, $CellContext`stheta0 > 0], Pi - 
              ArcSin[$CellContext`stheta0], $CellContext`theta0]; \
$CellContext`theta0 = If[
              And[$CellContext`ctheta0 < 0, $CellContext`stheta0 < 0], -Pi - 
              ArcSin[$CellContext`stheta0], $CellContext`theta0]; \
$CellContext`px = (-$CellContext`x2) (($CellContext`x1 - \
$CellContext`x2)/$CellContext`L2) - (-$CellContext`y2) (($CellContext`y2 - \
$CellContext`y1)/$CellContext`L2); $CellContext`py = (-$CellContext`x2) \
(($CellContext`y2 - $CellContext`y1)/$CellContext`L2) + (-$CellContext`y2) \
(($CellContext`x1 - $CellContext`x2)/$CellContext`L2); $CellContext`cctheta = \
($CellContext`x1 - $CellContext`x2)/$CellContext`L2; $CellContext`sstheta = \
($CellContext`y2 - $CellContext`y1)/$CellContext`L2; $CellContext`R1x = \
$CellContext`Xr2 + $CellContext`L1 
              Cos[$CellContext`theta0 + $CellContext`phi$$]; $CellContext`R1y = \
$CellContext`Yr2 + $CellContext`L1 
              Sin[$CellContext`theta0 + $CellContext`phi$$]; $CellContext`L31 = 
            Sqrt[($CellContext`R1x - $CellContext`Xr1)^2 + ($CellContext`R1y - \
$CellContext`Yr1)^2]; $CellContext`Cbeta = ($CellContext`L2^2 + \
$CellContext`L31^2 - $CellContext`L3^2)/(
             2 $CellContext`L31 $CellContext`L2); $CellContext`flag = 0; 
           If[-1 <= $CellContext`Cbeta <= 
             1, $CellContext`Sbeta = If[$CellContext`branch$$ == 1, 
                Sin[
                 ArcCos[$CellContext`Cbeta]], -Sin[
                  
                  ArcCos[$CellContext`Cbeta]]]; $CellContext`x22 = \
$CellContext`L2 $CellContext`Cbeta; $CellContext`y22 = $CellContext`L2 \
$CellContext`Sbeta; $CellContext`calpha = ($CellContext`Xr1 - \
$CellContext`R1x)/$CellContext`L31; $CellContext`salpha = ($CellContext`Yr1 - \
$CellContext`R1y)/$CellContext`L31; $CellContext`R11x = (-$CellContext`R1x) \
$CellContext`calpha - $CellContext`R1y $CellContext`salpha; $CellContext`R11y = \
$CellContext`R1x $CellContext`salpha - $CellContext`R1y $CellContext`calpha; \
$CellContext`R2x = ($CellContext`x22 - $CellContext`R11x) $CellContext`calpha - \
($CellContext`y22 - $CellContext`R11y) $CellContext`salpha; $CellContext`R2y = \
($CellContext`x22 - $CellContext`R11x) $CellContext`salpha + \
($CellContext`y22 - $CellContext`R11y) $CellContext`calpha; \
$CellContext`Ctheta = ($CellContext`R2x - $CellContext`R1x)/$CellContext`L2; \
$CellContext`Stheta = ($CellContext`R2y - $CellContext`R1y)/$CellContext`L2; \
$CellContext`ctheta = $CellContext`Ctheta $CellContext`cctheta - \
$CellContext`Stheta $CellContext`sstheta; $CellContext`stheta = \
$CellContext`Stheta $CellContext`cctheta + $CellContext`Ctheta \
$CellContext`sstheta; $CellContext`theta = If[
                And[$CellContext`ctheta < 0, $CellContext`stheta > 0], Pi - 
                ArcSin[$CellContext`stheta], 
                ArcSin[$CellContext`stheta]]; $CellContext`theta = If[
                And[$CellContext`ctheta < 0, $CellContext`stheta < 0], -Pi - 
                ArcSin[$CellContext`stheta], 
                
                ArcSin[$CellContext`stheta]]; $CellContext`Px = \
$CellContext`px $CellContext`Ctheta - $CellContext`py $CellContext`Stheta + \
$CellContext`R1x; $CellContext`Py = $CellContext`px $CellContext`Stheta + \
$CellContext`py $CellContext`Ctheta + $CellContext`R1y]; If[
             
             Or[$CellContext`Cbeta < -1, $CellContext`Cbeta > 
              
              1], $CellContext`R2x = $CellContext`R1x; $CellContext`R2y = \
$CellContext`R1y; $CellContext`Px = $CellContext`R1x; $CellContext`Py = \
$CellContext`R1y; $CellContext`theta = 0; $CellContext`flag = 
              1]]]; $CellContext`weight = $CellContext`view$$ 
         20; $CellContext`Pxx = $CellContext`Px + $CellContext`weight 
          Cos[$CellContext`theta]; $CellContext`Pyx = $CellContext`Py + \
$CellContext`weight 
          Sin[$CellContext`theta]; $CellContext`Pxax = $CellContext`Pxx + 
         0.25 $CellContext`weight 
          Cos[$CellContext`theta]; $CellContext`Pyax = $CellContext`Pyx + 
         0.25 $CellContext`weight 
          Sin[$CellContext`theta]; $CellContext`Pxy = $CellContext`Px + \
$CellContext`weight 
          Cos[$CellContext`theta + 
            Pi/2]; $CellContext`Pyy = $CellContext`Py + $CellContext`weight 
          Sin[$CellContext`theta + 
            Pi/2]; $CellContext`Pxay = $CellContext`Pxy + 
         0.25 $CellContext`weight 
          Cos[$CellContext`theta + 
            Pi/2]; $CellContext`Pyay = $CellContext`Pyy + 
         0.25 $CellContext`weight 
          Sin[$CellContext`theta + Pi/2]; $CellContext`barL1 = 
        Line[{{$CellContext`Xr2, $CellContext`Yr2}, {$CellContext`R1x, \
$CellContext`R1y}}]; $CellContext`shaft1 = {
          EdgeForm[Thick], 
          
          Disk[{$CellContext`Xr2, $CellContext`Yr2}, $CellContext`view$$]}; \
$CellContext`pivot1 = {
          EdgeForm[Thick], 
          
          Disk[{$CellContext`R1x, $CellContext`R1y}, 
           1 $CellContext`view$$]}; $CellContext`input = {{$CellContext`Xr2, \
$CellContext`Yr2}, $CellContext`Rr2}; 
       If[$CellContext`IsP != 
         1, $CellContext`barL3 = 
          Line[{{$CellContext`Xr1, $CellContext`Yr1}, {$CellContext`R2x, \
$CellContext`R2y}}]; 
         If[$CellContext`flag == 1, $CellContext`barL3 = 
           Disk[{$CellContext`Xr1, $CellContext`Yr1}, $CellContext`view$$]]; \
$CellContext`shaft2 = {
            EdgeForm[Thick], 
            
            Disk[{$CellContext`Xr1, $CellContext`Yr1}, 
             1 $CellContext`view$$]}; $CellContext`pivot2 = {
            EdgeForm[Thick], 
            Disk[{$CellContext`R2x, $CellContext`R2y}, 
             1 $CellContext`view$$]}; $CellContext`output = \
{{$CellContext`Xr1, $CellContext`Yr1}, $CellContext`Rr1}]; 
       If[$CellContext`IsP == 
         1, $CellContext`output = {$CellContext`a, $CellContext`b, \
$CellContext`c}; $CellContext`pivot2 = $CellContext`pivot1; \
$CellContext`pivot2a = {
            EdgeForm[Thick], 
            
            Disk[{$CellContext`R2x, $CellContext`R2y}, 
             1 $CellContext`view$$]}; $CellContext`barL3 = $CellContext`barL1; \
$CellContext`shaft2a = 
          Line[{{-10 - 
              0.05 ($CellContext`a/Sqrt[$CellContext`a^2 + $CellContext`b^2]),
               10 ($CellContext`a/$CellContext`b) - \
$CellContext`c/$CellContext`b - 
              0.05 ($CellContext`b/
               Sqrt[$CellContext`a^2 + $CellContext`b^2])}, {
             10 + 0.05 ($CellContext`a/
                Sqrt[$CellContext`a^2 + $CellContext`b^2]), (-10) \
($CellContext`a/$CellContext`b) - $CellContext`c/$CellContext`b + 
              0.05 ($CellContext`b/
                Sqrt[$CellContext`a^2 + $CellContext`b^2])}}]; \
$CellContext`shaft2 = {
            EdgeForm[Thick], 
            
            Disk[{$CellContext`R2x - 
              0.1 ($CellContext`b/
               Sqrt[$CellContext`a^2 + $CellContext`b^2]), $CellContext`R2y + 
              0.1 ($CellContext`a/
                Sqrt[$CellContext`a^2 + $CellContext`b^2])}, \
$CellContext`view$$]}; 
         If[$CellContext`b == 
           0, $CellContext`shaft2a = 
            Line[{{$CellContext`c/$CellContext`a - 
                0.05, -10, -0.05}, {$CellContext`c/$CellContext`a + 0.05, 10, 
                0.05}}]; $CellContext`shaft2 = 
            Rectangle[{$CellContext`R2x - 0.1, $CellContext`R2y - 
               0.1}, {$CellContext`R2x + 0.1, $CellContext`R2y + 0.1}]]; 
         Null]; $CellContext`drawPoses[$CellContext`xInput, \
$CellContext`yInput, $CellContext`\[Theta]Input, 
         Length[$CellContext`xInput]]; $CellContext`movingBody = {
          EdgeForm[Thick], 
          
          Triangle[{{$CellContext`R1x, $CellContext`R1y}, {$CellContext`R2x, \
$CellContext`R2y}, {$CellContext`Px, $CellContext`Py}}]}; \
$CellContext`moving1 = 
        Line[{{$CellContext`R1x, $CellContext`R1y}, {$CellContext`Px, \
$CellContext`Py}}]; $CellContext`moving2 = 
        Line[{{$CellContext`R2x, $CellContext`R2y}, {$CellContext`Px, \
$CellContext`Py}}]; $CellContext`movingpoint = {
          RGBColor[1, 1, 0], {
           PointSize[0.01], 
           Point[{$CellContext`Px, $CellContext`Py}]}}; $CellContext`movingX = {
          Arrowheads[0.05], 
          
          Arrow[{{$CellContext`Px, $CellContext`Py}, {$CellContext`Pxx, \
$CellContext`Pyx}}]}; $CellContext`movingY = {
          Arrowheads[0.05], 
          
          Arrow[{{$CellContext`Px, $CellContext`Py}, {$CellContext`Pxy, \
$CellContext`Pyy}}]}; $CellContext`mechanism = 
        Graphics[{$CellContext`fixedFrame, $CellContext`posesFrame, {Purple, 
            Specularity[0.5], 
            Opacity[0.7], $CellContext`movingBody}, $CellContext`movingpoint, {
            RGBColor[
            0.28, 0.67, 0.5], $CellContext`movingX, $CellContext`movingY}, {
           Yellow, $CellContext`pivot2, $CellContext`pivot1}, {
           Green, $CellContext`shaft1, $CellContext`shaft2}, {
            Thickness[Large], Red, 
            Specularity[0.8], $CellContext`barL1, $CellContext`barL3}}, 
          ImageSize -> {300, 300}, 
          PlotRange -> {{(-100) $CellContext`view$$, 
             100 $CellContext`view$$}, {(-100) $CellContext`view$$, 
             100 $CellContext`view$$}}]; Row[{
          
          Show[$CellContext`mechanism, Axes -> True, AxesStyle -> Gray, 
           PlotRange -> {{(-100) $CellContext`view$$, 
              100 $CellContext`view$$}, {(-100) $CellContext`view$$, 
              100 $CellContext`view$$}}], 
          Row[{
            Spacer[200], 
            Text[
             Grid[{{
                Style["Crank Dyad", Large], 
                Style[$CellContext`input, Large]}, {
                Style["Output Dyad", Large], 
                Style[$CellContext`output, Large]}, {
                Style["Moving Pivot 1", Large], 
                Style[{$CellContext`x2, $CellContext`y2}, Large]}, {
                Style["Moving Pivot 2", Large], 
                Style[{$CellContext`x1, $CellContext`y1}, Large]}}, Frame -> 
              All]]}]}]), 
      "Specifications" :> {{{$CellContext`branch$$, 2, "branch"}, {
         1 -> "1", 2 -> "2"}, ControlType -> 
         Setter}, {{$CellContext`phi$$, 0, "rotate"}, 0, 2 Pi, 0.01, 
         Appearance -> "Labeled"}, {{$CellContext`view$$, 0.3, "view range"}, 
         0.01, 1}}, 
      "Options" :> {
       TrackedSymbols -> Manipulate, AutorunSequencing -> {1, 2, 3, 6}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1007., {231., 238.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.69429407997441*^9, 3.6942941755881357`*^9, 3.6942952391818666`*^9, 
   3.6942960635237007`*^9, 3.694296313735178*^9, 3.69429638234023*^9, 
   3.694315403974832*^9, 3.694315670686243*^9, 3.694351214151532*^9, {
   3.694437470552498*^9, 3.694437517388228*^9}, 3.694437571761293*^9, 
   3.696354985102475*^9, {3.696355167921706*^9, 3.696355181717292*^9}, 
   3.6963641044506807`*^9, 3.696364527539625*^9, 3.6967158231808496`*^9, 
   3.69671599774032*^9, 3.696716452984356*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Qg1", "=", 
   RowBox[{"p", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qg2", "=", 
   RowBox[{"p", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.6967166838889723`*^9, 3.696716686230456*^9}, {
   3.6967169215781565`*^9, 3.696716932216053*^9}, {3.6967173326577206`*^9, 
   3.6967173482005415`*^9}, {3.696717429447008*^9, 3.6967174302633266`*^9}, 
   3.696718567980769*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G1", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"Qg1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "0", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "2"]},
      {"0", 
       RowBox[{"Qg1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       FractionBox[
        RowBox[{
         RowBox[{"Qg1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"Qg1", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "-", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]},
      {
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{
         RowBox[{"Qg1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"Qg1", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "2"], 
       RowBox[{
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "+", 
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], 
       FractionBox[
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "2"]},
      {
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "-", 
          RowBox[{"Qg1", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "2"], 
       RowBox[{
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "-", 
        RowBox[{"Qg1", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G2", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"Qg2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "0", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "2"]},
      {"0", 
       RowBox[{"Qg2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       FractionBox[
        RowBox[{
         RowBox[{"Qg2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"Qg2", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "-", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]},
      {
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{
         RowBox[{"Qg2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"Qg2", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "2"], 
       RowBox[{
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "+", 
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], 
       FractionBox[
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "2"]},
      {
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "-", 
          RowBox[{"Qg2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], 
       FractionBox[
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "2"], 
       RowBox[{
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "8", "]"}], "]"}], "-", 
        RowBox[{"Qg2", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}]}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.6967174708036733`*^9, 3.6967174765071263`*^9}, {
   3.6967175883971357`*^9, 3.6967176649546585`*^9}, {3.69671773873485*^9, 
   3.696717740694374*^9}, {3.696717796370837*^9, 3.6967181553014636`*^9}, 
   3.696718567980769*^9, {3.696718624135335*^9, 3.696718627789239*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", "=", 
  RowBox[{"Eigenvectors", "[", "G1", "]"}]}]], "Input",
 CellChangeTimes->{{3.696718593054907*^9, 3.6967186401955194`*^9}, {
   3.6967188654840546`*^9, 3.696718893470973*^9}, {3.6967189360069137`*^9, 
   3.6967189399859886`*^9}, 3.6967190065523405`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.030946777392885618`", ",", "0.05881800531775459`", ",", 
     RowBox[{"-", "0.9690704610450559`"}], ",", 
     RowBox[{"-", "0.2376661119077729`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4625845893992816`"}], ",", "0.24338639564844614`", ",", 
     RowBox[{"-", "0.20306245654167335`"}], ",", "0.8279759651142158`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7544575799386523`", ",", 
     RowBox[{"-", "0.396953801010481`"}], ",", 
     RowBox[{"-", "0.12450476419015939`"}], ",", "0.5076613079902746`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.46459827237346213`", ",", "0.8830238867250592`", ",", 
     "0.06454954660674316`", ",", "0.015830881637739304`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6967188815618253`*^9, 3.6967188950776787`*^9}, 
   3.696718941346698*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 190, 2, 87, "Title"],
Cell[773, 26, 4700, 67, 69, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[5476, 95, 326, 8, 30, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[5805, 105, 351, 8, 42, "Output"],
Cell[CellGroupData[{
Cell[6181, 117, 16093, 373, 19, "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[22277, 492, 26477, 624, 1304, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[48757, 1118, 9909, 202, 19, "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[58669, 1322, 77017, 1824, 19, "Input",
 CellOpen->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[135701, 3149, 2824, 44, 107, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[138528, 3195, 901, 19, 30, "Output"],
Cell[CellGroupData[{
Cell[139454, 3218, 986, 17, 30, "Input"],
Cell[140443, 3237, 46717, 822, 486, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187197, 4064, 552, 13, 50, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[187752, 4079, 5569, 169, 249, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[193358, 4253, 287, 5, 30, "Input"],
Cell[193648, 4260, 912, 23, 30, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

